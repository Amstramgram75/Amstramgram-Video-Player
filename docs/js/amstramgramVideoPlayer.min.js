/*
amstramgramVideoPlayer.js
@licence : MIT
@author : Amstramgram
@version : 1.0.0
@url : https://github.com/Amstramgram75/Amstramgram-Video-Player
*/
var AmstramgramVideoPlayer=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function a(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=window,r=document,l=o.PointerEvent?"pointer":o.TouchEvent?"touch":"mouse",u="touch"==l?"none":l+"enter",c="touch"==l?"none":l+"leave",m="touch"==l?"touchstart":l+"down",d="touch"==l?"touchend":l+"up",p=l+"move",v=o.navigator.userAgent.toLowerCase(),f=/ipad|iphone|ipod/i.test(v)&&!o.MSStream||/android/i.test(v);null==Element.prototype.getAttributeNames&&(Element.prototype.getAttributeNames=function(){for(var t=this.attributes,e=t.length,n=new Array(e),a=0;a<e;a++)n[a]=t[a].name;return n});var h,_,b=function(){try{var t="__storage_test__";return o.sessionStorage.setItem(t,t),o.sessionStorage.removeItem(t),o.sessionStorage}catch(t){return!1}}();if(b&&b.getItem("amst_timeWidth"))h=b.getItem("amst_timeWidth"),_=b.getItem("amst_longTimeWidth");else{var g=r.createElement("div"),y=r.createElement("div");g.classList.add("amst__measureTime"),g.innerHTML="<span>00:00<span>",y.classList.add("amst__measureTime"),y.innerHTML="<span>00:00:00<span>",r.body.appendChild(g),r.body.appendChild(y),h=g.offsetWidth+2,_=y.offsetWidth+2,r.body.removeChild(g),r.body.removeChild(y),b&&(b.setItem("amst_timeWidth",h),b.setItem("amst_longTimeWidth",_))}var E=r.createElement("style");E.appendChild(r.createTextNode("")),r.head.appendChild(E),E.sheet.insertRule(".amst__time>span{width:".concat(h,"px;"),0),E.sheet.insertRule(".amst__long .amst__time>span{width:".concat(_,"px;"),0);var w,T,L=!1;if(b&&null!=b.getItem("amst_fullscreenAPI")?L=JSON.parse(b.getItem("amst_fullscreenAPI")):(L=function(){for(var t,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenchange"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitfullscreenchange"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitfullscreenchange"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozfullscreenchange"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","MSFullscreenChange"]],n=0,a=e.length,s={};n<a;n++)if((t=e[n])&&t[1]in r){for(n=0;n<t.length;n++)s[e[0][n]]=t[n];return s}return!1}(),b.setItem("amst_fullscreenAPI",JSON.stringify(L))),b&&null!=b.getItem("amst_transitionPrefix")&&null!=b.getItem("amst_transformPrefix"))w=b.getItem("amst_transitionPrefix"),T=b.getItem("amst_transformPrefix");else{var k=function(t){for(var e=r.createElement("div"),n="",a=0;a<t.length;++a){if(void 0!==e.style[t[a]]){n=t[a];break}n=null}return n};w=k(["transition","msTransition","MozTransition","WebkitTransition","OTransition"]),T=k(["transform","msTransform","MozTransform","WebkitTransform","OTransform"]),b.setItem("amst_transitionPrefix",w),b.setItem("amst_transformPrefix",T)}var x="unknown";if(b&&b.getItem("amst_pointerType"))x=b.getItem("amst_pointerType");else{var A=function(t){x=t.pointerType?t.pointerType:"mouse",I()},C=function(){x="touch",I()},I=function(){b.setItem("amst_pointerType",x),o.removeEventListener(p,A),o.removeEventListener("touchstart",C),M.players.length>0&&M.players.forEach((function(t){return t.container.dispatchEvent(new CustomEvent("pointerDetected"))}))};o.addEventListener(p,A,!1)}var P=!1;b&&b.getItem("amst_supportPassiveEvents")?P=b.getItem("amst_supportPassiveEvents"):r.createElement("div").addEventListener("test",(function(){}),{get passive(){return P=!0,b.setItem("amst_supportPassiveEvents",P),!1}});var M=function(){function n(a,v){var h=this;e(this,n);var _=["autoplay","loop","muted","playsinline"],g=_.concat(["crossorigin","poster","preload","src"]);this.params=a.getAttributeNames().reduce((function(t,e){return g.includes(e)&&(t[e]=!!_.includes(e)||a.getAttribute(e)),t}),{}),this.params.muted&&(this.params.volume=0,delete this.params.muted),parseInt(a.getAttribute("width"))>0&&parseInt(a.getAttribute("height"))>0&&(this.params.format=parseInt(a.getAttribute("width"))/parseInt(a.getAttribute("height"))),g=g.filter((function(t){return"muted"!=t})).concat(["download","duration","format","fullscreen","hideControlsDelay","next","onInit","previous","skipTime","thumbnails","videoVolumeOrientation","volume","volumeButton","volumeForced","volumeGroup","railMinWidthForNormalUI"]),v&&(v=Object.keys(v).filter((function(t){return g.includes(t)})).reduce((function(t,e){return t[e]=v[e],t}),{})),v&&(this.params=z(this.params,v)),this.params=z(n.defaultOptions,this.params);var y=r.createElement("div"),E="horizontal"==this.params.videoVolumeOrientation?"horizontal":"vertical",k=P;y.classList.add("amst__wrapper"),y.classList.add("amst__video"),y.innerHTML=function(t){var e="",n="";f||(n='\n      <div class="amst__volume-slider" aria-label="'.concat(t.volumeSliderLabel,'" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" aria-valuetext="100%" role="slider" aria-orientation="').concat(t.videoVolumeOrientation,'" tabindex="0" title="').concat(t.volumeHelpLabel,'">\n        <span class="amst__offscreen">').concat(t.volumeHelpLabel,'</span>\n        <div class="amst__volume-total">\n          <div class="amst__volume-current" style="height: 100%;"></div>'),"horizontal"!=t.videoVolumeOrientation&&(n+='<div class="amst__volume-handle" style="bottom: 100%; margin-bottom: -3px;"></div>'),n+="</div></div>");e='\n    <div class="amst__button amst__volumebutton">\n      <button type="button" tabindex="0"></button>',"horizontal"!=t.videoVolumeOrientation?e+=n+"</div>":e+="</div>"+n;var a='\n    <span class="amst__offscreen">'.concat(t.appLabel,'</span>\n    <div class="amst__container" tabindex="0" role="application" aria-label="').concat(t.appLabel,'">\n      <div class="amst__mediaelement">\n        <video></video>\n      </div>\n    <div class="amst__layers">\n      <div class="amst__layer-poster">\n        <canvas></canvas>\n      </div>\n      <div class="amst__layer-loading">\n        <div class="amst__loading">\n          <span class="amst__svg"></span>\n        </div>\n      </div>\n      <div class="amst__layer-play">\n        <div class="amst__svg" role="button" tabindex="0" aria-label="').concat(t.playLabel,'" aria-pressed="false"></div>\n      </div>\n      <div class="amst__layer-seeking-touch">\n        <div class="amst__seeking-touch-cache"></div>\n        <span class="amst__time amst__seeking-touch">\n          <span></span>\n        </span>\n      </div>\n    </div>\n    <div class="amst__controls">\n      <div class="amst__button amst__previous">\n        <button type="button" title="').concat(t.previous.label,'" aria-label="').concat(t.previous.label,'" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__playpause">\n        <button type="button" title="').concat(t.playLabel,'" aria-label="').concat(t.playLabel,'" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__next">\n        <button type="button" title="').concat(t.next.label,'" aria-label="').concat(t.next.label,'" tabindex="0"></button>\n      </div>\n      <div class="amst__time" role="timer" aria-live="off">\n        <span class="amst__currenttime">00:00</span>\n      </div>\n      <div class="amst__rail">\n        <span class="amst__slider" role="slider" tabindex="0">\n          <span class="amst__buffering-bar"></span>\n          <canvas class="amst__loaded-bar"></canvas>\n          <span class="amst__currenttime-bar"></span>\n          <span class="amst__handle"><span></span></span>\n          <span class="amst__cursor"><span></span></span>\n          <span class="amst__seeking-wrapper">\n            <span class="amst__time amst__seeking">\n              <span>00:00</span>\n            </span>\n          </span>\n        </span>\n      </div>\n      <div class="amst__time amst__time-duration">\n        <span class="amst__duration">00:00</span>\n      </div>');a+=e,L&&(a+='        \n      <div class="amst__button amst__fullscreen">\n        <button type="button" title="'.concat(t.fullscreen.label,'" aria-label="').concat(t.fullscreen.label,'" tabindex="0"></button>\n      </div>'));return a+='\n      <div class="amst__button amst__download">\n        <button type="button" title="'.concat(t.download.label,'" aria-label="').concat(t.download.label,'" tabindex="0"></button>\n      </div>\n    </div>\n  ')}(this.params),a.parentNode.insertBefore(y,a),a.setAttribute("src",""),a.parentNode.removeChild(a);var A,C,I,M,O,H,X,j,q,R,D,G,V,U,Y,J=this,Q=N(y),K=W(y),Z=this.media=Q("video"),$=this.container=Q(".amst__container"),tt=Q(".amst__layer-poster"),et=Q(".amst__layer-poster canvas"),nt=Q(".amst__layer-seeking-touch"),at=Q(".amst__seeking-touch"),st=Q(".amst__layer-play"),it=Q(".amst__layer-loading"),ot=Q(".amst__controls"),rt=2*ot.css("padding-left"),lt=Q(".amst__playpause>button"),ut=Q(".amst__rail"),ct=Q(".amst__slider"),mt=Q(".amst__handle"),dt=Q(".amst__currenttime-bar"),pt=Q(".amst__seeking"),vt=Q(".amst__volumebutton button"),ft=Q(".amst__volume-slider"),ht=0,_t=0,bt=!1,gt=!1,yt=!1,Et=0;function wt(){var t=Z.play();t&&t.catch((function(){setTimeout((function(){(t=Z.play()).catch((function(){return Tt()}))}),50)})),n.currentPlayer&&n.currentPlayer!=J&&n.currentPlayer.reset(),n.currentPlayer=J,$.focus(),lt.setAttributes({class:"amst__pause",title:J.params.pauseLabel,"aria-label":J.params.pauseLabel}),st.classList.add("amst__hidden"),bt||Lt({detail:{delayed:!0}})}function Tt(){Z.pause(),lt.setAttributes({class:"",title:J.params.playLabel,"aria-label":J.params.playLabel}),st.classList.remove("amst__hidden"),kt(),$.focus()}function Lt(t){var e=!!t&&t.detail.delayed,n=!!t&&t.detail.forced;Z.paused&&!n||(e||gt||bt?(R&&clearTimeout(R),R=setTimeout((function(){return Lt()}),J.params.hideControlsDelay)):($.focus(),ot.style[T]="translateX(-50%) scaleY(0)",yt=!0))}function kt(){R&&clearTimeout(R),ot.style[T]="",yt=!1,Z.paused||Lt({detail:{delayed:!0}})}function xt(){window.location=J.src.substring(0,J.src.lastIndexOf("/"))+"/index.php?file="+J.src.substring(J.src.lastIndexOf("/")+1)}function At(t,e){var n=t.toLowerCase(),a=Q(".amst__".concat(n)),s=Q(".amst__".concat(n," > button"));!0===J.params[t].disabled?s.setAttribute("disabled",""):s.removeAttribute("disabled"),!0===J.params[t].hidden?a.classList.add("amst__hidden"):a.classList.remove("amst__hidden"),"volumeButton"==t&&ft&&(!0===J.params.volumeButton.disabled||!0===J.params.volumeButton.hidden?ft.classList.add("amst__hidden"):ft.classList.remove("amst__hidden")),s.setAttributes({title:e,"aria-label":e}),Yt()}function Ct(){At("previous",J.params.previous.label)}function It(){At("next",J.params.next.label)}function Pt(){!1===J.params.download.disabled&&!1===J.params.download.hidden?Q(".amst__download>button").on("click",xt,!1):Q(".amst__download>button").off("click",xt),At("download",J.params.download.label)}function Mt(){U=J.params.fullscreen.label.enter,Y=J.params.fullscreen.label.exit,At("fullscreen",n.currentFullScreenPlayer==J?Y:U)}function Bt(){At("volumeButton",0==J.volume?J.params.volumeButton.label.unmute:J.params.volumeButton.label.mute)}function Ft(e){var a=e.detail;a="object"===t(a)?a:{src:a},isNaN(a.volume)||!0!==a.volumeForced&&b.getItem("amst_volumegroup".concat(a.volumeGroup))?b.getItem("amst_volumegroup".concat(a.volumeGroup))&&(J.params.volume=b.getItem("amst_volumegroup".concat(a.volumeGroup))):(J.params.volume=a.volume,b.setItem("amst_volumegroup".concat(a.volumeGroup),a.volume));var s=["autoplay","crossorigin","download","duration","format","fullscreen","loop","next","playsinline","poster","preload","previous","src","skipTime","thumbnails","volumeButton","volumeGroup"];if(a=s.reduce((function(t,e){return s.includes(e)&&null!=a[e]&&(t[e]=a[e]),t}),{}),Z.getAttribute("src")){for($.classList.add("amst_container_transition"),J.media.pause(),_t=0,ht=0,q=void 0;Z.attributes.length>0;)Z.removeAttribute(Z.attributes[0].name);["autoplay","crossorigin","loop","playsinline","thumbnails"].forEach((function(t){return J.params[t]=n.defaultOptions[t]})),$.classList.remove("amst__thumbnails","amst__loadedmetadata"),Et=0,D=void 0,pt.removeAttribute("style"),G=void 0,at.removeAttribute("style"),J.params=z(J.params,a)}if(J.params.thumbnails.src){var i=new Image,o=function t(e){if(i.removeEventListener("load",t),i.removeEventListener("error",t),"load"==e.type){$.classList.add("amst__thumbnails"),Et=i.naturalWidth/J.params.thumbnails.number;var n={width:"".concat(i.naturalWidth/J.params.thumbnails.number,"px"),height:"".concat(i.naturalHeight,"px"),"background-image":'url("'.concat(J.params.thumbnails.src,'")')};pt.css(n),at.css(n)}else J.params.thumbnails.src=void 0};i.addEventListener("error",o,!1),i.addEventListener("load",o,!1),i.src=J.params.thumbnails.src}var r={src:J.params.src,preload:f?"none":J.params.preload};!0===J.params.playsinline&&(r.playsinline="",r["webkit-playsinline"]=""),!0===J.params.loop&&(r.loop=""),J.params.crossorigin&&(r.crossorigin=J.params.crossorigin),Z.setAttributes(r),J.volume=f&&J.params.volume>0?1:J.params.volume,V||(V=0==Z.volume?.1:Z.volume,f&&(V=1)),$.style.paddingBottom=1/J.params.format*100+"%",J.params.poster&&(tt.style.backgroundImage='url("'.concat(J.params.poster,'")'),tt.classList.remove("amst__hidden")),Q(".amst__duration").innerHTML=B(J.params.duration),Q(".amst__currenttime").innerHTML=B(0,J.params.duration>3600),Ct(),It(),Pt(),Bt(),L&&Mt(),!0===J.params.autoplay&&wt()}this.events={next:[],previous:[]},$.on("amstEvent__play",wt,!1),$.on("amstEvent__pause",Tt,!1),$.on("amstEvent__reset",(function(){et.width=Z.videoWidth,et.height=Z.videoHeight,et.getContext("2d").drawImage(Z,0,0,et.width,et.height),tt.classList.remove("amst__hidden"),$.classList.remove("amst__loadedmetadata"),Z.src="",Z.preload="none",Z.src=J.params.src}),!1),$.on("amstEvent__hideControls",Lt,!1),$.on("amstEvent__showControls",kt,!1),Q(".amst__next").on("click",(function(){var t=this;i(J.events.next).forEach((function(e){return e.bind(t)}))})),Q(".amst__previous").on("click",(function(){var t=this;i(J.events.previous).forEach((function(e){return e.bind(t)}))})),Q(".amst__next").on("click",(function(){var t=this;i(J.events.next).forEach((function(e){return e.apply(t)}))})),Q(".amst__previous").on("click",(function(){var t=this;i(J.events.previous).forEach((function(e){return e.apply(t)}))})),$.on("amstEvent__previousButton",Ct,!1),$.on("amstEvent__nextButton",It,!1),$.on("amstEvent__fullscreenButton",Mt,!1),$.on("amstEvent__downloadButton",Pt,!1),$.on("amstEvent__volumeButton",Bt,!1),$.on("amstEvent__src",Ft,!1),Ft({detail:this.params}),Z.on("mousemove",(function(){return kt()}),!!k&&{passive:!0}).on("loadedmetadata",(function(){var t=h.params.format=Z.videoWidth/Z.videoHeight;n.currentFullScreenPlayer==J?o.dispatchEvent(new CustomEvent("optimizedResize")):$.style.paddingBottom=1/t*100+"%",$.classList.add("amst__loadedmetadata"),Z.currentTime=ht})).on("loadeddata",(function(){Z.currentTime=ht})).on("durationchange",(function(){h.params.duration=Z.duration,j="string"==typeof h.params.skipTime&&"%"==h.params.skipTime.slice(-1)?parseFloat(h.params.skipTime)*Z.duration/100:parseFloat(h.params.skipTime),Z.duration>=3600?$.classList.add("amst__long"):$.classList.remove("amst__long"),ct.setAttribute("aria-valuemax",Z.duration),Q(".amst__duration").innerHTML=B(Z.duration),Q(".amst__currenttime").innerHTML=B(ht,Z.duration>3600),Yt()})).on("progress",Nt).on("timeupdate",(function(){if(!isNaN(Z.duration)){Nt(),ct.setAttribute("aria-valuenow",Z.currentTime);var t=Math.floor(Z.currentTime);if(ht!=t){var e=B(ht=t,Z.duration>3600);Q(".amst__currenttime").innerHTML=e,ct.setAttribute("aria-valuetext",e)}(0==_t||Math.abs(Z.currentTime-_t)>.5)&&(cancelAnimationFrame(X),Ht()),_t=Z.currentTime}})).on("ended",(function(){Z.currentTime=0,h.pause()})).on("pause",(function(){return cancelAnimationFrame(X)})).on("playing",(function(){_t=0,tt.classList.add("amst__hidden")})).on("seeked",(function(){0==ht&&h.paused&&(et.width=0,et.height=0,tt.classList.remove("amst__hidden"))})).on("play playing seeked canplay",(function(){gt=!1,$.classList.remove("amst__buffering")})).on("seeking waiting loadeddata",(function(){gt=!0,$.classList.add("amst__buffering")}));var St=Q(".amst__loaded-bar"),Ot=St.offsetHeight,zt=St.getContext("2d");function Nt(){if(!function(t,e){if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t.start(n)!=e.start(n)||t.end(n)!=e.end(n))return n=t.length,!1;return!0}(Z.buffered,q)){zt.clearRect(0,0,St.width,St.height);for(var t=St.width/Z.duration,e=0;e<Z.buffered.length;e++){var n=Z.buffered.start(e)*t,a=Z.buffered.end(e)*t-n;new F(zt,Ot,n,a)}q=Z.buffered}}St.height=Ot,zt.fillStyle=St.css("color");var Wt=.5*mt.offsetWidth;function Ht(){var t,e,n,a,i=Z.paused&&!Z.seeking?"all .15s ease-in":"none",o=Z.currentTime,r=Z.duration,l=isNaN(r)?0:(o/r).toFixed(4),u=l*M-Wt;(u=Math.max(u,0),u=Math.min(u,M-2*Wt)+"px",Z.paused)?(dt.css((s(t={},w,i),s(t,T,"scaleX(".concat(l,")")),t)),mt.css((s(e={},w,i),s(e,T,"translateX(".concat(u,")")),e))):(dt.css((s(n={},w,i),s(n,T,"scaleX(".concat(l,")")),n)),mt.css((s(a={},w,i),s(a,T,"translateX(".concat(u,")")),a)),X=requestAnimationFrame(Ht))}function Xt(t){var e=((t.changedTouches?t.changedTouches[0].clientX:t.clientX)-I)/M;Z.currentTime=e*Z.duration}function jt(t){J.paused||bt||Lt({detail:{delayed:!0}}),Xt(t),ut.off(p,Xt),ut.off(d+" "+c,jt)}if(K([Z,it,nt,st]).on("touchstart",(function(t){var e=Q(t.target),n=(new Date).getTime(),a=200,i=Z.duration?Z.currentTime/Z.duration:void 0,o=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY,l=0,u=0,c=0,m=void 0,d=!1;function p(t){if(Z.duration&&!(J.paused&&c<-5))if(d)t.preventDefault();else{if(c>-5&&t.preventDefault(),l=t.changedTouches[0].pageX-o,u=t.changedTouches[0].pageY-r,Math.abs(l)>Math.abs(u)?c++:c--,c>=5){m=Math.min(Math.max(i+l/A,0),.999),G||(G=at.offsetWidth);var e=Math.min(Math.max(m*A-.5*G,0),A-G)+"px",n=s({},T,"translateX(".concat(e,")"));J.params.thumbnails.src&&(n.backgroundPosition=-Math.floor(100*m)*Et+"px 0"),at.css(n),Q(".amst__seeking-touch-cache").style[T]="scaleX(".concat(m,")"),Q(".amst__seeking-touch > span").innerHTML=B(Z.duration*m,Z.duration>3600),5==c&&(nt.classList.add("amst__show"),Lt({detail:{delayed:!1,forced:!0}}))}-5==c&&(u<0?yt&&(kt(),d=!0):yt||(Lt(),d=!0))}}e.on("touchend",(function t(s){null!=m?(Z.currentTime=Z.duration*m,nt.classList.remove("amst__show"),kt()):d||a>(new Date).getTime()-n&&J.togglePlayPause();e.off("touchend",t);e.off("touchmove",p)}),!!k&&{passive:!0}),e.on("touchmove",p,!!k&&{passive:!1})}),!!k&&{passive:!1}),K([Z,it]).on("click",(function(){return h.pause()}),!1),$.on("touchstart mousedown",(function(){$.classList.remove("amst__keyboard-active")}),!!k&&{passive:!0}),Q(".amst__playpause").on("click",(function(){return h.togglePlayPause()})),st.on("click",(function(){return h.play()})),ot.on(u,(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType)return!1;kt(),bt=!0})).on(c,(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType)return!1;bt=!1,Lt({detail:{delayed:!0}})})),ut.on(m,(function(){if(isNaN(Z.duration))return!1;ut.on(p,Xt,!!k&&{passive:!0}),ut.on(d+" "+c,jt,!1)}),!!k&&{passive:!0}),S(p,"optimizedPointerMove",ct),ct.on("optimizedPointerMove",(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType||isNaN(Z.duration))return!1;D||(D=pt.offsetWidth);var e=t.detail.clientX-I,n=e/M,a=-Math.floor(100*n)*Et+"px",s=.5*D-6;J.params.thumbnails.src&&(pt.style.backgroundPosition=a+" 0"),Q(".amst__cursor").style[T]="translateX(".concat(e,"px)"),e=Math.max(e,s),e=Math.min(e,M-s),Q(".amst__seeking-wrapper").style[T]="translateX(".concat(e,"px)"),Q(".amst__seeking > span").innerHTML=B(n*Z.duration,Z.duration>3600)})),Z.on("volumechange",(function(){if(!f){var t=parseInt(100*Z.volume);ft.setAttributes({"aria-valuenow":t,"aria-valuetext":t+"%"}),"horizontal"==E?Q(".amst__volume-current").style.width=t+"%":Q(".amst__volume-handle").style.bottom=t+"%"}0==Z.volume?(Z.muted=!0,vt.setAttributes({title:J.params.volumeButton.label.unmute,"aria-label":J.params.volumeButton.label.unmute,class:"amst__unmute"})):(Z.muted=!1,V=Z.volume,vt.classList.contains("amst__unmute")&&(vt.removeAttribute("class"),vt.setAttributes({title:J.params.volumeButton.label.mute,"aria-label":J.params.volumeButton.label.mute}))),b&&J.params.volumeGroup>-1&&b.setItem("amst_volumegroup".concat(J.params.volumeGroup),J.volume),J.params.volume=J.volume,J.params.volumeGroup>-1&&n.players.length>1&&n.players.forEach((function(t){t!=J&&t.params.volumeGroup==J.params.volumeGroup&&t.volume!=J.volume&&(t.volume=J.volume)}))})),vt.on("click",(function(){Z.muted?(Z.volume=V,Z.muted=!1):(Z.volume=0,Z.muted=!0)})),!f){ft.on(m,(function(){ft.on(p,qt).on(c,Rt).on(d,qt).on(d,Rt)}));var qt=function(t){var e;"horizontal"==E?(e=Math.max(0,t.clientX-C.left),e=(e/=C.width)>.96?1:e):(ft.style.cursor="ns-resize",e=C.height-t.clientY+C.top,e=Math.max(0,Math.min(e,100))/100),J.volume=e},Rt=function t(){ft.off(p,qt).off(c,t).off(d,qt).off(d,t),"vertical"==E&&(ft.style.cursor="")};$.on("keydown",(function(t){switch($.classList.add("amst__keyboard-active"),kt(),[37,38,39,40,77].includes(t.which)&&t.preventDefault(),t.which>36&&t.which<41&&(38!=t.which&&40!=t.which||r.activeElement==ft||("vertical"==E?(ft.on("transitionend",(function t(){this.removeEventListener("transitionend",t),this.focus()})),vt.focus()):ft.focus()),37!=t.which&&39!=t.which||r.activeElement==ct||ct.focus()),t.which){case 77:!0!==J.params.volumeButton.disabled&&!0!==J.params.volumeButton.hidden&&(vt.dispatchEvent(new MouseEvent("click")),vt.focus());break;case 40:!0!==J.params.volumeButton.disabled&&!0!==J.params.volumeButton.hidden&&(J.volume=Math.max(0,J.volume-.05));break;case 38:!0!==J.params.volumeButton.disabled&&!0!==J.params.volumeButton.hidden&&(J.volume=Math.min(1,J.volume+.05));break;case 37:J.currentTime=Math.max(0,J.currentTime-j);break;case 39:J.currentTime=Math.min(J.duration,J.currentTime+j);break;case 32:if(r.activeElement==lt)return;"BUTTON"!=r.activeElement.nodeName&&(t.preventDefault(),J.togglePlayPause())}}),!1)}if(L){var Dt=0,Gt=0,Vt=Q(".amst__fullscreen>button");Vt.on("click",(function(){null!==r[L.fullscreenElement]?r[L.exitFullscreen]():(Dt=o.pageXOffset,Gt=o.pageYOffset,y[L.requestFullscreen](),n.currentFullScreenPlayer=J)})),r.addEventListener(L.fullscreenchange,(function(){r[L.fullscreenElement]==y?(o.addEventListener("optimizedResize",Ut),y.classList.add("amst__isfullscreen"),$.classList.add("amst__notransition"),Vt.setAttributes({title:Y,"aria-label":Y,class:" amst__unfullscreen"}),Ut()):n.currentFullScreenPlayer==J&&(o.removeEventListener("optimizedResize",Ut),$.setAttribute("style","padding-bottom:".concat(1/J.params.format*100,"%")),y.classList.remove("amst__isfullscreen"),Vt.setAttributes({title:U,"aria-label":U,class:""}),setTimeout((function(){o.scroll(Dt,Gt),setTimeout((function(){$.classList.remove("amst__notransition")}),50)}),50),n.currentFullScreenPlayer=void 0)}),!1);var Ut=function(){o.innerWidth/o.innerHeight>J.params.format?$.css({width:o.innerHeight*J.params.format+"px",height:"100%",paddingBottom:0}):$.css({width:"100%",height:"auto",paddingBottom:1/J.params.format*100+"%"}),Jt()}}function Yt(){H&&clearTimeout(H),H=setTimeout((function(){O=0,K(".amst__controls>div:not(.amst__rail):not(.amst__hidden):not(.amst__time-duration)").forEach((function(t){t.classList.contains("amst__time")?O+=2*t.offsetWidth:O+=t.offsetWidth})),Jt()}),1)}function Jt(){(A=$.offsetWidth)-rt-O<n.defaultOptions.railMinWidthForNormalUI?$.classList.add("amst__compact"):$.classList.remove("amst__compact");var t=ct.getBoundingClientRect();if(I=t.left,M=t.width,Ht(),!f){var e=function t(e){C=Q(".amst__volume-total").getBoundingClientRect(),e&&e.target==$&&$.off("transitionend",t)};$.on("transitionend",e,!1),e()}}o.addEventListener("optimizedResize",Jt),o.addEventListener("optimizedScroll",Jt),"unknown"==x?$.addEventListener("pointerDetected",(function t(){$.removeEventListener("pointerDetected",t),"touch"!=x&&$.classList.add("amst__no-touch")}),!1):"touch"!=x&&$.classList.add("amst__no-touch"),n.players.push(this),v&&"function"==typeof v.onInit&&setTimeout((function(){v.onInit.call(J)}),0)}return a(n,null,[{key:"options",value:function(t){0==n.players.length&&(n.defaultOptions=z(n.defaultOptions,t))}}]),a(n,[{key:"pause",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__pause"))}},{key:"play",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__play"))}},{key:"reset",value:function(){this.pause(),this.container.dispatchEvent(new CustomEvent("amstEvent__reset"))}},{key:"togglePlayPause",value:function(){this.paused?this.play():this.pause()}},{key:"hideControls",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.container.dispatchEvent(new CustomEvent("amstEvent__hideControls",{detail:{delayed:t,forced:e}}))}},{key:"showControls",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__showControls"))}},{key:"previous",value:function(t){O(t)&&(this.params=z(this.params,{previous:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__previousButton")))}},{key:"next",value:function(t){O(t)&&(this.params=z(this.params.next,{next:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__nextButton")))}},{key:"fullscreen",value:function(t){O(t)&&(this.params=z(this.params,{fullscreen:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__fullscreenButton")))}},{key:"download",value:function(t){O(t)&&(this.params=z(this.params,{download:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__downloadButton")))}},{key:"volumeButton",value:function(t){O(t)&&(this.params=z(this.params,{volumeButton:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__volumeButton")))}},{key:"on",value:function(t,e){"next"!=t&&"previous"!=t||this.events[t].push(e)}},{key:"off",value:function(t,e){if("next"==t||"previous"==t){var n=this.events[t].indexOf(e);n>-1&&this.events[t].splice(n,1)}}},{key:"src",set:function(t){this.container.dispatchEvent(new CustomEvent("amstEvent__src",{detail:t}))},get:function(){return this.media.getAttribute("src")}},{key:"paused",get:function(){return this.media.paused}},{key:"duration",get:function(){return this.media.duration}},{key:"currentTime",set:function(t){this.media.duration&&t>=0&&t<=this.media.duration&&(this.media.currentTime=t)},get:function(){return this.media.currentTime}},{key:"volume",set:function(t){this.media.volume=t},get:function(){return this.media.volume}}]),n}();function B(t,e){t=Math.round(t);var n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),s=Math.round(t%60);return(n=n>9?n+":":n>0?"0"+n+":":e?"00:":"")+(a=a>9?a:"0"+a)+":"+(s=s>9?s:"0"+s)}M.currentPlayer=void 0,M.players=[],M.defaultOptions={autoplay:!1,crossorigin:"anonymous",download:{label:"Télécharger",disabled:!1,hidden:!1},duration:120,format:16/9,fullscreen:{label:{enter:"Plein écran",exit:"Quitter le plein écran"},disabled:!1,hidden:!1},loop:!1,next:{label:"Suivant",disabled:!0,hidden:!0},playsinline:!0,poster:void 0,preload:"none",previous:{label:"Précédent",disabled:!0,hidden:!0},skipTime:"1%",thumbnails:{src:void 0,number:100},volume:.8,volumeButton:{label:{mute:"Désactiver le son",unmute:"Activer le son"},disabled:!1,hidden:!1},volumeGroup:0,hideControlsDelay:5e3,videoVolumeOrientation:"vertical",railMinWidthForNormalUI:600,appLabel:"Lecteur Vidéo",pauseLabel:"Pause",playLabel:"Lecture",volumeHelpLabel:"Utilisez les flèches Haut/Bas du clavier pour augmenter ou diminuer le volume.",volumeSliderLabel:"Potentiomètre de volume"};var F=function t(n,a,s,i){e(this,t);n.beginPath(),n.moveTo(s+2,0),n.lineTo(s+i-2,0),n.quadraticCurveTo(s+i,0,s+i,2),n.lineTo(s+i,0+a-2),n.quadraticCurveTo(s+i,0+a,s+i-2,0+a),n.lineTo(s+2,0+a),n.quadraticCurveTo(s,0+a,s,0+a-2),n.lineTo(s,2),n.quadraticCurveTo(s,0,s+2,0),n.closePath(),n.fill()},S=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,a=!1,s=function(t){a||(a=!0,requestAnimationFrame((function(){n.dispatchEvent(new CustomEvent(e,{detail:t})),a=!1})))};n.addEventListener(t,s)};function O(e){return e&&"object"===t(e)&&!Array.isArray(e)}function z(t,e){var n=Object.assign({},t);return O(t)&&O(e)&&Object.keys(e).forEach((function(a){O(e[a])&&a in t?n[a]=z(t[a],e[a]):Object.assign(n,s({},a,e[a]))})),n}S("resize","optimizedResize"),S("scroll","optimizedScroll");var N=function(t){return function(e){var n="string"==typeof e?t.querySelector(e):e;return n&&(n.css=function(t){if("string"==typeof t){var e=o.getComputedStyle(n,null).getPropertyValue(t);return isNaN(parseFloat(e))?e:parseFloat(e)}return Object.assign(n.style,t),n},n.setAttributes=function(t){Object.keys(t).forEach((function(e){return n.setAttribute(e,t[e])}))},n.on=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.split(" ").forEach((function(t){return n.addEventListener(t,e,a)})),n},n.off=function(t,e){return t.split(" ").forEach((function(t){return n.removeEventListener(t,e)})),n}),n}},W=function(t){return function(e){var n=Array.isArray(e)?e:Array.from(t.querySelectorAll(e));return n.css=function(t){if("string"==typeof t){var e=window.getComputedStyle(n[0],null).getPropertyValue(t);return isNaN(parseFloat(e))?e:parseFloat(e)}return n.forEach((function(e){Object.assign(e.style,t)})),n},n.on=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.forEach((function(n){t.split(" ").forEach((function(t){return n.addEventListener(t,e,a)}))})),n},n.off=function(t,e){return n.forEach((function(n){t.split(" ").forEach((function(t){return n.removeEventListener(t,e)}))})),n},n.length?n:null}};return M}();
