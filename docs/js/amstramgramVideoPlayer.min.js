/*amstramgramVideoPlayer.js--@version:1.0.2--@licence:MIT--@url:https://github.com/Amstramgram75/Amstramgram-Video-Player*/
var AmstramgramVideoPlayer=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=window,r=document,l=o.PointerEvent?"pointer":o.TouchEvent?"touch":"mouse",u="touch"==l?"none":l+"enter",c="touch"==l?"none":l+"leave",m="touch"==l?"touchstart":l+"down",d="touch"==l?"touchend":l+"up",p=l+"move",v=o.navigator.userAgent.toLowerCase(),f=/ipad|iphone|ipod/i.test(v)&&!o.MSStream||/android/i.test(v);null==Element.prototype.getAttributeNames&&(Element.prototype.getAttributeNames=function(){for(var t=this.attributes,e=t.length,a=new Array(e),n=0;n<e;n++)a[n]=t[n].name;return a});var h,_,b=function(){try{var t="__storage_test__";return o.sessionStorage.setItem(t,t),o.sessionStorage.removeItem(t),o.sessionStorage}catch(t){return!1}}();if(b&&b.getItem("amst_timeWidth"))h=b.getItem("amst_timeWidth"),_=b.getItem("amst_longTimeWidth");else{var g=r.createElement("div"),y=r.createElement("div");g.classList.add("amst__measureTime"),g.innerHTML="<span>00:00<span>",y.classList.add("amst__measureTime"),y.innerHTML="<span>00:00:00<span>",r.body.appendChild(g),r.body.appendChild(y),h=g.offsetWidth+2,_=y.offsetWidth+2,r.body.removeChild(g),r.body.removeChild(y),b&&(b.setItem("amst_timeWidth",h),b.setItem("amst_longTimeWidth",_))}var E=r.createElement("style");E.appendChild(r.createTextNode("")),r.head.appendChild(E),E.sheet.insertRule(".amst__time>span{width:".concat(h,"px;"),0),E.sheet.insertRule(".amst__long .amst__time>span{width:".concat(_,"px;"),0);var w,L,T,k="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform);if(b&&null!=b.getItem("amst_fullscreenAPI")?w=JSON.parse(b.getItem("amst_fullscreenAPI")):(w=function(){for(var t,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenchange"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitfullscreenchange"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitfullscreenchange"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozfullscreenchange"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","MSFullscreenChange"]],a=0,n=e.length,s={};a<n;a++)if((t=e[a])&&t[1]in r){for(a=0;a<t.length;a++)s[e[0][a]]=t[a];return s}return{fake:!0,fullscreenchange:"fullscreenchange"}}(),b.setItem("amst_fullscreenAPI",JSON.stringify(w))),b&&null!=b.getItem("amst_transitionPrefix")&&null!=b.getItem("amst_transformPrefix"))L=b.getItem("amst_transitionPrefix"),T=b.getItem("amst_transformPrefix");else{var x=function(t){for(var e=r.createElement("div"),a="",n=0;n<t.length;++n){if(void 0!==e.style[t[n]]){a=t[n];break}a=null}return a};L=x(["transition","msTransition","MozTransition","WebkitTransition","OTransition"]),T=x(["transform","msTransform","MozTransform","WebkitTransform","OTransform"]),b.setItem("amst_transitionPrefix",L),b.setItem("amst_transformPrefix",T)}var A="unknown";if(b&&b.getItem("amst_pointerType"))A=b.getItem("amst_pointerType");else{var P=function(t){A=t.pointerType?t.pointerType:"mouse",I()},C=function(){A="touch",I()},I=function(){b.setItem("amst_pointerType",A),o.removeEventListener(p,P),o.removeEventListener("touchstart",C),B.players.length>0&&B.players.forEach((function(t){return t.container.dispatchEvent(new CustomEvent("pointerDetected"))}))};o.addEventListener(p,P,!1),o.addEventListener("touchstart",C,!1)}var M=!1;b&&b.getItem("amst_supportPassiveEvents")?M=b.getItem("amst_supportPassiveEvents"):r.createElement("div").addEventListener("test",(function(){}),{get passive(){return M=!0,b.setItem("amst_supportPassiveEvents",M),!1}});var B=function(){function a(n,v){var h=this;e(this,a);var _=["autoplay","loop","muted","playsinline"],g=_.concat(["crossorigin","poster","preload","src"]);this.params=n.getAttributeNames().reduce((function(t,e){return g.includes(e)&&(t[e]=!!_.includes(e)||n.getAttribute(e)),t}),{}),this.params.muted&&(this.params.volume=0,delete this.params.muted),parseInt(n.getAttribute("width"))>0&&parseInt(n.getAttribute("height"))>0&&(this.params.format=parseInt(n.getAttribute("width"))/parseInt(n.getAttribute("height"))),g=g.filter((function(t){return"muted"!=t})).concat(["download","duration","format","fullscreen","hideControlsDelay","next","onInit","previous","skipTime","thumbnails","videoVolumeOrientation","volume","volumeButton","volumeForced","volumeGroup","railMinWidthForNormalUI"]),v&&(v=Object.keys(v).filter((function(t){return g.includes(t)})).reduce((function(t,e){return t[e]=v[e],t}),{})),v&&(this.params=N(this.params,v)),this.params=N(a.defaultOptions,this.params);var y=r.createElement("div"),E="horizontal"==this.params.videoVolumeOrientation?"horizontal":"vertical",x=M;y.classList.add("amst__wrapper"),y.classList.add("amst__video"),y.innerHTML=function(t){var e="",a="";f||(a='\n      <div class="amst__volume-slider" aria-label="'.concat(t.volumeSliderLabel,'" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" aria-valuetext="100%" role="slider" aria-orientation="').concat(t.videoVolumeOrientation,'" tabindex="0" title="').concat(t.volumeHelpLabel,'">\n        <span class="amst__offscreen">').concat(t.volumeHelpLabel,'</span>\n        <div class="amst__volume-total">\n          <div class="amst__volume-current" style="height: 100%;"></div>'),"horizontal"!=t.videoVolumeOrientation&&(a+='<div class="amst__volume-handle" style="bottom: 100%; margin-bottom: -3px;"></div>'),a+="</div></div>");e='\n    <div class="amst__button amst__volumebutton">\n      <button type="button" tabindex="0"></button>',"horizontal"!=t.videoVolumeOrientation?e+=a+"</div>":e+="</div>"+a;var n='\n    <span class="amst__offscreen">'.concat(t.appLabel,'</span>\n    <div class="amst__container" tabindex="0" role="application" aria-label="').concat(t.appLabel,'">\n      <div class="amst__mediaelement">\n        <video></video>\n      </div>\n    <div class="amst__layers">\n      <div class="amst__layer-poster">\n        <canvas></canvas>\n      </div>\n      <div class="amst__layer-loading">\n        <div class="amst__loading">\n          <span class="amst__svg"></span>\n        </div>\n      </div>\n      <div class="amst__layer-play">\n        <div class="amst__svg" role="button" tabindex="0" aria-label="').concat(t.playLabel,'" aria-pressed="false"></div>\n      </div>\n      <div class="amst__layer-seeking-touch">\n        <div class="amst__seeking-touch-cache"></div>\n        <span class="amst__time amst__seeking-touch">\n          <span></span>\n        </span>\n      </div>\n    </div>\n    <div class="amst__controls">\n      <div class="amst__button amst__previous">\n        <button type="button" title="').concat(t.previous.label,'" aria-label="').concat(t.previous.label,'" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__playpause">\n        <button type="button" title="').concat(t.playLabel,'" aria-label="').concat(t.playLabel,'" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__next">\n        <button type="button" title="').concat(t.next.label,'" aria-label="').concat(t.next.label,'" tabindex="0"></button>\n      </div>\n      <div class="amst__time" role="timer" aria-live="off">\n        <span class="amst__currenttime">00:00</span>\n      </div>\n      <div class="amst__rail">\n        <span class="amst__slider" role="slider" tabindex="0">\n          <span class="amst__buffering-bar"></span>\n          <canvas class="amst__loaded-bar"></canvas>\n          <span class="amst__currenttime-bar"></span>\n          <span class="amst__handle"><span></span></span>\n          <span class="amst__cursor"><span></span></span>\n          <span class="amst__seeking-wrapper">\n            <span class="amst__time amst__seeking">\n              <span>00:00</span>\n            </span>\n          </span>\n        </span>\n      </div>\n      <div class="amst__time amst__time-duration">\n        <span class="amst__duration">00:00</span>\n      </div>');n+=e,w&&(n+='        \n      <div class="amst__button amst__fullscreen">\n        <button type="button" title="'.concat(t.fullscreen.label,'" aria-label="').concat(t.fullscreen.label,'" tabindex="0"></button>\n      </div>'));return n+='\n      <div class="amst__button amst__download">\n        <button type="button" title="'.concat(t.download.label,'" aria-label="').concat(t.download.label,'" tabindex="0"></button>\n      </div>\n    </div>\n  ')}(this.params),n.parentNode.insertBefore(y,n),n.setAttribute("src",""),n.removeAttribute("src"),n.load(),n.parentNode.removeChild(n);var P,C,I,B,z,X,j,q,D,R,G,V,U,Y,J,Q=this,K=W(y),Z=H(y),$=this.media=K("video"),tt=this.container=K(".amst__container"),et=K(".amst__layer-poster"),at=K(".amst__layer-poster canvas"),nt=K(".amst__layer-seeking-touch"),st=K(".amst__seeking-touch"),it=K(".amst__layer-play"),ot=K(".amst__layer-loading"),rt=K(".amst__controls"),lt=2*rt.css("padding-left"),ut=K(".amst__playpause>button"),ct=K(".amst__rail"),mt=K(".amst__slider"),dt=K(".amst__handle"),pt=K(".amst__currenttime-bar"),vt=K(".amst__seeking"),ft=K(".amst__volumebutton button"),ht=K(".amst__volume-slider"),_t=0,bt=0,gt=!1,yt=!1,Et=!1,wt=0;function Lt(){tt.classList.contains("amst__loadedmetadata")||$.load();var t=$.play();t&&t.catch((function(){setTimeout((function(){(t=$.play()).catch((function(t){Tt(),console.log("Error initiating video playback : ",t)}))}),50)})),a.currentPlayer&&a.currentPlayer!=Q&&a.currentPlayer.reset(),a.currentPlayer=Q,tt.focus(),ut.setAttributes({class:"amst__pause",title:Q.params.pauseLabel,"aria-label":Q.params.pauseLabel}),it.classList.add("amst__hidden"),gt||kt({detail:{delayed:!0}})}function Tt(){$.pause(),ut.setAttributes({class:"",title:Q.params.playLabel,"aria-label":Q.params.playLabel}),it.classList.remove("amst__hidden"),xt(),tt.focus()}function kt(t){var e=!!t&&t.detail.delayed,a=!!t&&t.detail.forced;$.paused&&!a||(e||yt||gt?(R&&clearTimeout(R),R=setTimeout((function(){return kt()}),Q.params.hideControlsDelay)):(tt.focus(),rt.style[T]="translateX(-50%) scaleY(0)",Et=!0))}function xt(){R&&clearTimeout(R),rt.style[T]="",Et=!1,$.paused||kt({detail:{delayed:!0}})}function At(){window.location=Q.src.substring(0,Q.src.lastIndexOf("/"))+"/index.php?file="+Q.src.substring(Q.src.lastIndexOf("/")+1)}function Pt(t,e){var a=t.toLowerCase(),n=K(".amst__".concat(a)),s=K(".amst__".concat(a," > button"));!0===Q.params[t].disabled?s.setAttribute("disabled",""):s.removeAttribute("disabled"),!0===Q.params[t].hidden?n.classList.add("amst__hidden"):n.classList.remove("amst__hidden"),"volumeButton"==t&&ht&&(!0===Q.params.volumeButton.disabled||!0===Q.params.volumeButton.hidden?ht.classList.add("amst__hidden"):ht.classList.remove("amst__hidden")),s.setAttributes({title:e,"aria-label":e}),Jt()}function Ct(){Pt("previous",Q.params.previous.label)}function It(){Pt("next",Q.params.next.label)}function Mt(){!1===Q.params.download.disabled&&!1===Q.params.download.hidden?K(".amst__download>button").on("click",At,!1):K(".amst__download>button").off("click",At),Pt("download",Q.params.download.label)}function Bt(){Y=Q.params.fullscreen.label.enter,J=Q.params.fullscreen.label.exit,Pt("fullscreen",a.currentFullScreenPlayer==Q?J:Y)}function Ft(){Pt("volumeButton",0==Q.volume?Q.params.volumeButton.label.unmute:Q.params.volumeButton.label.mute)}function St(e){var n=e.detail;n="object"===t(n)?n:{src:n},isNaN(n.volume)||!0!==n.volumeForced&&b.getItem("amst_volumegroup".concat(n.volumeGroup))?b.getItem("amst_volumegroup".concat(n.volumeGroup))&&(Q.params.volume=b.getItem("amst_volumegroup".concat(n.volumeGroup))):(Q.params.volume=n.volume,b.setItem("amst_volumegroup".concat(n.volumeGroup),n.volume));var s=["autoplay","crossorigin","download","duration","format","fullscreen","loop","next","playsinline","poster","preload","previous","src","skipTime","thumbnails","volumeButton","volumeGroup"];if(n=s.reduce((function(t,e){return s.includes(e)&&null!=n[e]&&(t[e]=n[e]),t}),{}),$.getAttribute("src")){for(tt.classList.add("amst_container_transition"),Q.media.pause(),bt=0,_t=0,D=void 0;$.attributes.length>0;)$.removeAttribute($.attributes[0].name);["autoplay","crossorigin","loop","playsinline","thumbnails"].forEach((function(t){return Q.params[t]=a.defaultOptions[t]})),tt.classList.remove("amst__thumbnails","amst__loadedmetadata"),wt=0,G=void 0,vt.removeAttribute("style"),V=void 0,st.removeAttribute("style"),Q.params=N(Q.params,n)}if(Q.params.thumbnails.src&&!k){var i=new Image,o=function t(e){if(i.removeEventListener("load",t),i.removeEventListener("error",t),"load"==e.type){tt.classList.add("amst__thumbnails"),wt=i.naturalWidth/Q.params.thumbnails.number;var a={width:"".concat(i.naturalWidth/Q.params.thumbnails.number,"px"),height:"".concat(i.naturalHeight,"px"),"background-image":'url("'.concat(Q.params.thumbnails.src,'")')};vt.css(a),st.css(a)}else Q.params.thumbnails.src=void 0};i.addEventListener("error",o,!1),i.addEventListener("load",o,!1),i.src=Q.params.thumbnails.src}var r={src:Q.params.src,preload:f?"none":Q.params.preload};!0===Q.params.playsinline&&(r.playsinline="",r["webkit-playsinline"]=""),!0===Q.params.loop&&(r.loop=""),Q.params.crossorigin&&(r.crossorigin=Q.params.crossorigin),$.setAttributes(r),Q.volume=f&&Q.params.volume>0?1:Q.params.volume,U||(U=0==$.volume?.1:$.volume,f&&(U=1)),$.dispatchEvent(new CustomEvent("volumechange")),tt.style.paddingBottom=1/Q.params.format*100+"%",Q.params.poster&&(et.style.backgroundImage='url("'.concat(Q.params.poster,'")'),et.classList.remove("amst__hidden")),K(".amst__duration").innerHTML=F(Q.params.duration),K(".amst__currenttime").innerHTML=F(0,Q.params.duration>3600),Ct(),It(),Mt(),Ft(),w&&Bt(),1==Q.params.autoplay&&($.load(),Lt())}this.events={next:[],previous:[]},tt.on("amstEvent__play",Lt,!1),tt.on("amstEvent__pause",Tt,!1),tt.on("amstEvent__reset",(function(){at.width=$.videoWidth,at.height=$.videoHeight,at.getContext("2d").drawImage($,0,0,at.width,at.height),et.classList.remove("amst__hidden"),tt.classList.remove("amst__loadedmetadata"),$.src="",$.preload="none",$.load(),$.src=Q.params.src}),!1),tt.on("amstEvent__hideControls",kt,!1),tt.on("amstEvent__showControls",xt,!1),K(".amst__next").on("click",(function(){var t=this;i(Q.events.next).forEach((function(e){return e.apply(t)}))})),K(".amst__previous").on("click",(function(){var t=this;i(Q.events.previous).forEach((function(e){return e.apply(t)}))})),tt.on("amstEvent__previousButton",Ct,!1),tt.on("amstEvent__nextButton",It,!1),tt.on("amstEvent__fullscreenButton",Bt,!1),tt.on("amstEvent__downloadButton",Mt,!1),tt.on("amstEvent__volumeButton",Ft,!1),tt.on("amstEvent__src",St,!1),$.on("mousemove",(function(){return xt()}),!!x&&{passive:!0}).on("loadedmetadata",(function(){var t=h.params.format=$.videoWidth/$.videoHeight;a.currentFullScreenPlayer==Q?o.dispatchEvent(new CustomEvent("amst__optimizedResize")):tt.style.paddingBottom=1/t*100+"%",tt.classList.add("amst__loadedmetadata"),$.currentTime=_t})).on("loadeddata",(function(){$.currentTime=_t})).on("durationchange",(function(){h.params.duration=$.duration,q="string"==typeof h.params.skipTime&&"%"==h.params.skipTime.slice(-1)?parseFloat(h.params.skipTime)*$.duration/100:parseFloat(h.params.skipTime),$.duration>=3600?tt.classList.add("amst__long"):tt.classList.remove("amst__long"),mt.setAttribute("aria-valuemax",$.duration),K(".amst__duration").innerHTML=F($.duration),K(".amst__currenttime").innerHTML=F(_t,$.duration>3600),Jt()})).on("progress",Wt).on("timeupdate",(function(){if(!isNaN($.duration)){Wt(),mt.setAttribute("aria-valuenow",$.currentTime);var t=Math.floor($.currentTime);if(_t!=t){var e=F(_t=t,$.duration>3600);K(".amst__currenttime").innerHTML=e,mt.setAttribute("aria-valuetext",e)}(0==bt||Math.abs($.currentTime-bt)>.5)&&(cancelAnimationFrame(j),Xt()),bt=$.currentTime}})).on("ended",(function(){$.currentTime=0,h.pause()})).on("pause",(function(){return cancelAnimationFrame(j)})).on("playing",(function(){bt=0,et.classList.add("amst__hidden")})).on("seeked",(function(){0==_t&&h.paused&&(at.width=0,at.height=0,et.classList.remove("amst__hidden"))})).on("play playing seeked canplay",(function(){yt=!1,tt.classList.remove("amst__buffering")})).on("seeking waiting loadeddata",(function(){yt=!0,tt.classList.add("amst__buffering")}));var Ot=K(".amst__loaded-bar"),zt=Ot.offsetHeight,Nt=Ot.getContext("2d");function Wt(){if(!function(t,e){if(!t||!e||t.length!=e.length)return!1;for(var a=0;a<t.length;a++)if(t.start(a)!=e.start(a)||t.end(a)!=e.end(a))return a=t.length,!1;return!0}($.buffered,D)){Nt.clearRect(0,0,Ot.width,Ot.height);for(var t=Ot.width/$.duration,e=0;e<$.buffered.length;e++){var a=$.buffered.start(e)*t,n=$.buffered.end(e)*t-a;new S(Nt,zt,a,n)}D=$.buffered}}Ot.height=zt,Nt.fillStyle=Ot.css("color");var Ht=.5*dt.offsetWidth;function Xt(){var t,e,a,n,i=$.paused&&!$.seeking?"all .15s ease-in":"none",o=$.currentTime,r=$.duration,l=isNaN(r)?0:(o/r).toFixed(4),u=l*B-Ht;(u=Math.max(u,0),u=Math.min(u,B-2*Ht)+"px",$.paused)?(pt.css((s(t={},L,i),s(t,T,"scaleX(".concat(l,")")),t)),dt.css((s(e={},L,i),s(e,T,"translateX(".concat(u,")")),e))):(pt.css((s(a={},L,i),s(a,T,"scaleX(".concat(l,")")),a)),dt.css((s(n={},L,i),s(n,T,"translateX(".concat(u,")")),n)),j=requestAnimationFrame(Xt))}function jt(t){var e=((t.changedTouches?t.changedTouches[0].clientX:t.clientX)-I)/B;$.currentTime=e*$.duration}function qt(t){Q.paused||gt||kt({detail:{delayed:!0}}),jt(t),ct.off(p,jt),ct.off(d+" "+c,qt)}if(Z([$,ot,nt,it]).on("touchstart",(function(t){var e=K(t.target),a=(new Date).getTime(),n=200,i=$.duration?$.currentTime/$.duration:void 0,o=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY,l=0,u=0,c=0,m=void 0,d=!1;function p(t){if($.duration&&!(Q.paused&&c<-5))if(d)t.preventDefault();else{if(c>-5&&t.preventDefault(),l=t.changedTouches[0].pageX-o,u=t.changedTouches[0].pageY-r,Math.abs(l)>Math.abs(u)?c++:c--,c>=5&&!k){m=Math.min(Math.max(i+l/P,0),.999),V||(V=st.offsetWidth);var e=Math.min(Math.max(m*P-.5*V,0),P-V)+"px",a=s({},T,"translateX(".concat(e,")"));Q.params.thumbnails.src&&(a.backgroundPosition=-Math.floor(100*m)*wt+"px 0"),st.css(a),K(".amst__seeking-touch-cache").style[T]="scaleX(".concat(m,")"),K(".amst__seeking-touch > span").innerHTML=F($.duration*m,$.duration>3600),5==c&&(nt.classList.add("amst__show"),kt({detail:{delayed:!1,forced:!0}}))}-5==c&&(u<0?Et&&(xt(),d=!0):Et||(kt(),d=!0))}}e.on("touchend",(function t(s){s.preventDefault(),null!=m?($.currentTime=$.duration*m,nt.classList.remove("amst__show"),xt()):d||n>(new Date).getTime()-a&&Q.togglePlayPause();e.off("touchend",t),e.off("touchmove",p)}),!!x&&{passive:!1}),e.on("touchmove",p,!!x&&{passive:!1})}),!!x&&{passive:!1}),Z([$,ot]).on("click",(function(){return h.pause()}),!1),tt.on("touchstart mousedown",(function(){tt.classList.remove("amst__keyboard-active")}),!!x&&{passive:!0}),K(".amst__playpause").on("click",(function(){return h.togglePlayPause()})),it.on("click",(function(){return h.play()})),rt.on(u,(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType)return!1;xt(),gt=!0})).on(c,(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType)return!1;gt=!1,kt({detail:{delayed:!0}})})),ct.on(m,(function(){if(isNaN($.duration))return!1;ct.on(p,jt,!!x&&{passive:!0}),ct.on(d+" "+c,qt,!1)}),!!x&&{passive:!0}),O(p,"optimizedPointerMove",mt),mt.on("optimizedPointerMove",(function(t){if("touch"==l||t.pointerType&&"touch"==t.pointerType||isNaN($.duration))return!1;G||(G=vt.offsetWidth);var e=t.detail.clientX-I,a=e/B,n=-Math.floor(100*a)*wt+"px",s=.5*G-6;Q.params.thumbnails.src&&(vt.style.backgroundPosition=n+" 0"),K(".amst__cursor").style[T]="translateX(".concat(e,"px)"),e=Math.max(e,s),e=Math.min(e,B-s),K(".amst__seeking-wrapper").style[T]="translateX(".concat(e,"px)"),K(".amst__seeking > span").innerHTML=F(a*$.duration,$.duration>3600)})),$.on("volumechange",(function(){if(!f){var t=parseInt(100*$.volume);ht.setAttributes({"aria-valuenow":t,"aria-valuetext":t+"%"}),"horizontal"==E?K(".amst__volume-current").style.width=t+"%":K(".amst__volume-handle").style.bottom=t+"%"}$.muted?ft.setAttributes({title:Q.params.volumeButton.label.unmute,"aria-label":Q.params.volumeButton.label.unmute,class:"amst__unmute"}):(U=$.volume,ft.classList.contains("amst__unmute")&&(ft.removeAttribute("class"),ft.setAttributes({title:Q.params.volumeButton.label.mute,"aria-label":Q.params.volumeButton.label.mute}))),b&&Q.params.volumeGroup>-1&&b.setItem("amst_volumegroup".concat(Q.params.volumeGroup),Q.volume),Q.params.volume=Q.volume,Q.params.volumeGroup>-1&&a.players.length>1&&a.players.forEach((function(t){t!=Q&&t.params.volumeGroup==Q.params.volumeGroup&&t.volume!=Q.volume&&(t.volume=Q.volume)}))})),ft.on("click",(function(){$.muted?($.volume=U,$.muted=!1):($.volume=0,$.muted=!0)})),!f){ht.on(m,(function(){ht.on(p,Dt).on(c,Rt).on(d,Dt).on(d,Rt)}));var Dt=function(t){var e;"horizontal"==E?(e=Math.max(0,t.clientX-C.left),e=(e/=C.width)>.96?1:e):(ht.style.cursor="ns-resize",e=C.height-t.clientY+C.top,e=Math.max(0,Math.min(e,100))/100),Q.volume=e},Rt=function t(){ht.off(p,Dt).off(c,t).off(d,Dt).off(d,t),"vertical"==E&&(ht.style.cursor="")};tt.on("keydown",(function(t){switch(tt.classList.add("amst__keyboard-active"),xt(),[37,38,39,40,77].includes(t.which)&&t.preventDefault(),t.which>36&&t.which<41&&(38!=t.which&&40!=t.which||r.activeElement==ht||("vertical"==E?(ht.on("transitionend",(function t(){this.removeEventListener("transitionend",t),this.focus()})),ft.focus()):ht.focus()),37!=t.which&&39!=t.which||r.activeElement==mt||mt.focus()),t.which){case 77:!0!==Q.params.volumeButton.disabled&&!0!==Q.params.volumeButton.hidden&&(ft.dispatchEvent(new MouseEvent("click")),ft.focus());break;case 40:!0!==Q.params.volumeButton.disabled&&!0!==Q.params.volumeButton.hidden&&(Q.volume=Math.max(0,Q.volume-.05));break;case 38:!0!==Q.params.volumeButton.disabled&&!0!==Q.params.volumeButton.hidden&&(Q.volume=Math.min(1,Q.volume+.05));break;case 37:Q.currentTime=Math.max(0,Q.currentTime-q);break;case 39:Q.currentTime=Math.min(Q.duration,Q.currentTime+q);break;case 32:if(r.activeElement==ut)return;"BUTTON"!=r.activeElement.nodeName&&(t.preventDefault(),Q.togglePlayPause())}}),!1)}var Gt=0,Vt=0,Ut=K(".amst__fullscreen>button");Ut.on("click",(function(){a.currentFullScreenPlayer?(a.currentFullScreenPlayer=void 0,w.fake?(y.classList.remove("amst__fakefullscreen"),r.dispatchEvent(new Event(w.fullscreenchange))):r[w.exitFullscreen]()):(Gt=o.pageXOffset,Vt=o.pageYOffset,a.currentFullScreenPlayer=Q,w.fake?(y.classList.add("amst__fakefullscreen"),r.dispatchEvent(new Event(w.fullscreenchange))):y[w.requestFullscreen]())})),r.addEventListener(w.fullscreenchange,(function(){a.currentFullScreenPlayer==Q?(o.addEventListener("amst__optimizedResize",Yt),y.classList.add("amst__isfullscreen"),tt.classList.add("amst__notransition"),Ut.setAttributes({title:J,"aria-label":J,class:" amst__unfullscreen"}),Yt()):(o.removeEventListener("amst__optimizedResize",Yt),tt.setAttribute("style","padding-bottom:".concat(1/Q.params.format*100,"%")),y.classList.remove("amst__isfullscreen"),Ut.setAttributes({title:Y,"aria-label":Y,class:""}),setTimeout((function(){o.scroll(Gt,Vt),Qt(),setTimeout((function(){tt.classList.remove("amst__notransition")}),50)}),50))}),!1);var Yt=function(){o.innerWidth/o.innerHeight>Q.params.format?tt.css({width:o.innerHeight*Q.params.format+"px",height:"100%",paddingBottom:0}):tt.css({width:"100%",height:"auto",paddingBottom:1/Q.params.format*100+"%"}),Qt()};function Jt(){X&&clearTimeout(X),X=setTimeout((function(){z=0,Z(".amst__controls>div:not(.amst__rail):not(.amst__hidden):not(.amst__time-duration)").forEach((function(t){t.classList.contains("amst__time")?z+=2*t.offsetWidth:z+=t.offsetWidth})),Qt()}),1)}function Qt(){(P=tt.offsetWidth)-lt-z<a.defaultOptions.railMinWidthForNormalUI?tt.classList.add("amst__compact"):tt.classList.remove("amst__compact");var t=mt.getBoundingClientRect();if(I=t.left,B=t.width,Xt(),!f){var e=function t(e){C=K(".amst__volume-total").getBoundingClientRect(),e&&e.target==tt&&tt.off("transitionend",t)};tt.on("transitionend",e,!1),e()}}o.addEventListener("amst__optimizedResize",Qt),o.addEventListener("amst__optimizedScroll",Qt),"unknown"==A?tt.addEventListener("pointerDetected",(function t(){tt.removeEventListener("pointerDetected",t),"touch"!=A&&tt.classList.add("amst__no-touch")}),!1):"touch"!=A&&tt.classList.add("amst__no-touch"),a.players.push(this),St({detail:this.params}),v&&"function"==typeof v.onInit&&setTimeout((function(){v.onInit.call(Q)}),0)}return n(a,null,[{key:"options",value:function(t){0==a.players.length&&(a.defaultOptions=N(a.defaultOptions,t))}}]),n(a,[{key:"pause",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__pause"))}},{key:"play",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__play"))}},{key:"reset",value:function(){this.pause(),this.container.dispatchEvent(new CustomEvent("amstEvent__reset"))}},{key:"togglePlayPause",value:function(){this.paused?this.play():this.pause()}},{key:"hideControls",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.container.dispatchEvent(new CustomEvent("amstEvent__hideControls",{detail:{delayed:t,forced:e}}))}},{key:"showControls",value:function(){this.container.dispatchEvent(new CustomEvent("amstEvent__showControls"))}},{key:"previous",value:function(t){z(t)&&(this.params=N(this.params,{previous:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__previousButton")))}},{key:"next",value:function(t){z(t)&&(this.params=N(this.params.next,{next:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__nextButton")))}},{key:"fullscreen",value:function(t){z(t)&&(this.params=N(this.params,{fullscreen:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__fullscreenButton")))}},{key:"download",value:function(t){z(t)&&(this.params=N(this.params,{download:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__downloadButton")))}},{key:"volumeButton",value:function(t){z(t)&&(this.params=N(this.params,{volumeButton:t}),this.container.dispatchEvent(new CustomEvent("amstEvent__volumeButton")))}},{key:"on",value:function(t,e){this.events.hasOwnProperty(t)&&this.events[t].push(e)}},{key:"off",value:function(t,e){if(this.events.hasOwnProperty(t)){var a=this.events[t].indexOf(e);a>-1&&this.events[t].splice(a,1)}}},{key:"src",set:function(t){this.container.dispatchEvent(new CustomEvent("amstEvent__src",{detail:t}))},get:function(){return this.media.getAttribute("src")}},{key:"paused",get:function(){return this.media.paused}},{key:"duration",get:function(){return this.media.duration}},{key:"currentTime",set:function(t){this.media.duration&&t>=0&&t<=this.media.duration&&(this.media.currentTime=t)},get:function(){return this.media.currentTime}},{key:"volume",set:function(t){this.media.muted=0==t,this.media.volume=t},get:function(){return this.media.volume}}]),a}();function F(t,e){t=Math.round(t);var a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),s=Math.round(t%60);return(a=a>9?a+":":a>0?"0"+a+":":e?"00:":"")+(n=n>9?n:"0"+n)+":"+(s=s>9?s:"0"+s)}B.currentPlayer=void 0,B.players=[],B.defaultOptions={autoplay:!1,crossorigin:"anonymous",download:{label:"Télécharger",disabled:!1,hidden:!1},duration:120,format:16/9,fullscreen:{label:{enter:"Plein écran",exit:"Quitter le plein écran"},disabled:!1,hidden:!1},loop:!1,next:{label:"Suivant",disabled:!0,hidden:!0},playsinline:!0,poster:void 0,preload:"none",previous:{label:"Précédent",disabled:!0,hidden:!0},skipTime:"1%",thumbnails:{src:void 0,number:100},volume:.8,volumeButton:{label:{mute:"Désactiver le son",unmute:"Activer le son"},disabled:!1,hidden:!1},volumeGroup:0,hideControlsDelay:5e3,videoVolumeOrientation:"vertical",railMinWidthForNormalUI:600,appLabel:"Lecteur Vidéo",pauseLabel:"Pause",playLabel:"Lecture",volumeHelpLabel:"Utilisez les flèches Haut/Bas du clavier pour augmenter ou diminuer le volume.",volumeSliderLabel:"Potentiomètre de volume"};var S=function t(a,n,s,i){e(this,t);a.beginPath(),a.moveTo(s+2,0),a.lineTo(s+i-2,0),a.quadraticCurveTo(s+i,0,s+i,2),a.lineTo(s+i,0+n-2),a.quadraticCurveTo(s+i,0+n,s+i-2,0+n),a.lineTo(s+2,0+n),a.quadraticCurveTo(s,0+n,s,0+n-2),a.lineTo(s,2),a.quadraticCurveTo(s,0,s+2,0),a.closePath(),a.fill()},O=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,n=!1,s=function(t){n||(n=!0,requestAnimationFrame((function(){a.dispatchEvent(new CustomEvent(e,{detail:t})),n=!1})))};a.addEventListener(t,s)};function z(e){return e&&"object"===t(e)&&!Array.isArray(e)}function N(t,e){var a=Object.assign({},t);return z(t)&&z(e)&&Object.keys(e).forEach((function(n){z(e[n])&&n in t?a[n]=N(t[n],e[n]):Object.assign(a,s({},n,e[n]))})),a}O("resize","amst__optimizedResize"),O("scroll","amst__optimizedScroll");var W=function(t){return function(e){var a="string"==typeof e?t.querySelector(e):e;return a&&(a.css=function(t){if("string"==typeof t){var e=o.getComputedStyle(a,null).getPropertyValue(t);return isNaN(parseFloat(e))?e:parseFloat(e)}return Object.assign(a.style,t),a},a.setAttributes=function(t){Object.keys(t).forEach((function(e){return a.setAttribute(e,t[e])}))},a.on=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.split(" ").forEach((function(t){return a.addEventListener(t,e,n)})),a},a.off=function(t,e){return t.split(" ").forEach((function(t){return a.removeEventListener(t,e)})),a}),a}},H=function(t){return function(e){var a=Array.isArray(e)?e:Array.from(t.querySelectorAll(e));return a.css=function(t){if("string"==typeof t){var e=window.getComputedStyle(a[0],null).getPropertyValue(t);return isNaN(parseFloat(e))?e:parseFloat(e)}return a.forEach((function(e){Object.assign(e.style,t)})),a},a.on=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.forEach((function(a){t.split(" ").forEach((function(t){return a.addEventListener(t,e,n)}))})),a},a.off=function(t,e){return a.forEach((function(a){t.split(" ").forEach((function(t){return a.removeEventListener(t,e)}))})),a},a.length?a:null}};return B}();
