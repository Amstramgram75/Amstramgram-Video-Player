/*amstramgramVideoPlayer.js--@version:1.0.0--@licence:MIT--@url:https://github.com/Amstramgram75/Amstramgram-Video-Player*/
var AmstramgramVideoPlayer=function(){"use strict";const e=window,t=document,a=e.PointerEvent?"pointer":e.TouchEvent?"touch":"mouse",s="touch"==a?"none":a+"enter",n="touch"==a?"none":a+"leave",i="touch"==a?"touchstart":a+"down",o="touch"==a?"touchend":a+"up",r=a+"move",l=e.navigator.userAgent.toLowerCase(),u=/ipad|iphone|ipod/i.test(l)&&!e.MSStream||/android/i.test(l);null==Element.prototype.getAttributeNames&&(Element.prototype.getAttributeNames=function(){for(var e=this.attributes,t=e.length,a=new Array(t),s=0;s<t;s++)a[s]=e[s].name;return a});const m=function(){try{let t="__storage_test__";return e.sessionStorage.setItem(t,t),e.sessionStorage.removeItem(t),e.sessionStorage}catch(e){return!1}}();let d,c;if(m&&m.getItem("amst_timeWidth"))d=m.getItem("amst_timeWidth"),c=m.getItem("amst_longTimeWidth");else{const e=t.createElement("div"),a=t.createElement("div");e.classList.add("amst__measureTime"),e.innerHTML="<span>00:00<span>",a.classList.add("amst__measureTime"),a.innerHTML="<span>00:00:00<span>",t.body.appendChild(e),t.body.appendChild(a),d=e.offsetWidth+2,c=a.offsetWidth+2,t.body.removeChild(e),t.body.removeChild(a),m&&(m.setItem("amst_timeWidth",d),m.setItem("amst_longTimeWidth",c))}const p=t.createElement("style");p.appendChild(t.createTextNode("")),t.head.appendChild(p),p.sheet.insertRule(`.amst__time>span{width:${d}px;`,0),p.sheet.insertRule(`.amst__long .amst__time>span{width:${c}px;`,0);let v,h,_=!1;if(m&&null!=m.getItem("amst_fullscreenAPI")?_=JSON.parse(m.getItem("amst_fullscreenAPI")):(_=function(){let e,a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenchange"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitfullscreenchange"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitfullscreenchange"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozfullscreenchange"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","MSFullscreenChange"]],s=0,n=a.length,i={};for(;s<n;s++)if(e=a[s],e&&e[1]in t){for(s=0;s<e.length;s++)i[a[0][s]]=e[s];return i}return!1}(),m.setItem("amst_fullscreenAPI",JSON.stringify(_))),m&&null!=m.getItem("amst_transitionPrefix")&&null!=m.getItem("amst_transformPrefix"))v=m.getItem("amst_transitionPrefix"),h=m.getItem("amst_transformPrefix");else{let e=function(e){let a=t.createElement("div"),s="";for(let t=0;t<e.length;++t){if(void 0!==a.style[e[t]]){s=e[t];break}s=null}return s};v=e(["transition","msTransition","MozTransition","WebkitTransition","OTransition"]),h=e(["transform","msTransform","MozTransform","WebkitTransform","OTransform"]),m.setItem("amst_transitionPrefix",v),m.setItem("amst_transformPrefix",h)}let f="unknown";if(m&&m.getItem("amst_pointerType"))f=m.getItem("amst_pointerType");else{const t=function(e){f=e.pointerType?e.pointerType:"mouse",s()},a=function(){f="touch",s()},s=function(){m.setItem("amst_pointerType",f),e.removeEventListener(r,t),e.removeEventListener("touchstart",a),y.players.length>0&&y.players.forEach(e=>e.container.dispatchEvent(new CustomEvent("pointerDetected")))};e.addEventListener(r,t,!1)}let b=!1;m&&m.getItem("amst_supportPassiveEvents")?b=m.getItem("amst_supportPassiveEvents"):t.createElement("div").addEventListener("test",()=>{},{get passive(){return b=!0,m.setItem("amst_supportPassiveEvents",b),!1}});const g="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform);class y{static options(e){0==y.players.length&&(y.defaultOptions=x(y.defaultOptions,e))}constructor(l,d){const c=["autoplay","loop","muted","playsinline"];let p=c.concat(["crossorigin","poster","preload","src"]);this.params=l.getAttributeNames().reduce((e,t)=>(p.includes(t)&&(e[t]=!!c.includes(t)||l.getAttribute(t)),e),{}),this.params.muted&&(this.params.volume=0,delete this.params.muted),parseInt(l.getAttribute("width"))>0&&parseInt(l.getAttribute("height"))>0&&(this.params.format=parseInt(l.getAttribute("width"))/parseInt(l.getAttribute("height"))),p=p.filter(e=>"muted"!=e).concat(["download","duration","format","fullscreen","hideControlsDelay","next","onInit","previous","skipTime","thumbnails","videoVolumeOrientation","volume","volumeButton","volumeForced","volumeGroup","railMinWidthForNormalUI"]),d&&(d=Object.keys(d).filter(e=>p.includes(e)).reduce((e,t)=>(e[t]=d[t],e),{})),d&&(this.params=x(this.params,d)),this.params=x(y.defaultOptions,this.params);const L=t.createElement("div"),I="horizontal"==this.params.videoVolumeOrientation?"horizontal":"vertical",P=b;L.classList.add("amst__wrapper"),L.classList.add("amst__video"),L.innerHTML=function(e){let t="",a="";u||(a=`\n      <div class="amst__volume-slider" aria-label="${e.volumeSliderLabel}" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" aria-valuetext="100%" role="slider" aria-orientation="${e.videoVolumeOrientation}" tabindex="0" title="${e.volumeHelpLabel}">\n        <span class="amst__offscreen">${e.volumeHelpLabel}</span>\n        <div class="amst__volume-total">\n          <div class="amst__volume-current" style="height: 100%;"></div>`,"horizontal"!=e.videoVolumeOrientation&&(a+='<div class="amst__volume-handle" style="bottom: 100%; margin-bottom: -3px;"></div>'),a+="</div></div>");t='\n    <div class="amst__button amst__volumebutton">\n      <button type="button" tabindex="0"></button>',"horizontal"!=e.videoVolumeOrientation?t+=a+"</div>":t+="</div>"+a;let s=g?"amst__container amst__isIosDevice":"amst__container",n=`\n    <span class="amst__offscreen">${e.appLabel}</span>\n    <div class="${s}" tabindex="0" role="application" aria-label="${e.appLabel}">\n      <div class="amst__mediaelement">\n        <video></video>\n      </div>\n    <div class="amst__layers">\n      <div class="amst__layer-poster">\n        <canvas></canvas>\n      </div>\n      <div class="amst__layer-loading">\n        <div class="amst__loading">\n          <span class="amst__svg"></span>\n        </div>\n      </div>\n      <div class="amst__layer-play">\n        <div class="amst__svg" role="button" tabindex="0" aria-label="${e.playLabel}" aria-pressed="false"></div>\n      </div>\n      <div class="amst__layer-seeking-touch">\n        <div class="amst__seeking-touch-cache"></div>\n        <span class="amst__time amst__seeking-touch">\n          <span></span>\n        </span>\n      </div>\n    </div>\n    <div class="amst__controls">\n      <div class="amst__button amst__previous">\n        <button type="button" title="${e.previous.label}" aria-label="${e.previous.label}" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__playpause">\n        <button type="button" title="${e.playLabel}" aria-label="${e.playLabel}" tabindex="0"></button>\n      </div>\n      <div class="amst__button amst__next">\n        <button type="button" title="${e.next.label}" aria-label="${e.next.label}" tabindex="0"></button>\n      </div>\n      <div class="amst__time" role="timer" aria-live="off">\n        <span class="amst__currenttime">00:00</span>\n      </div>\n      <div class="amst__rail">\n        <span class="amst__slider" role="slider" tabindex="0">\n          <span class="amst__buffering-bar"></span>\n          <canvas class="amst__loaded-bar"></canvas>\n          <span class="amst__currenttime-bar"></span>\n          <span class="amst__handle"><span></span></span>\n          <span class="amst__cursor"><span></span></span>\n          <span class="amst__seeking-wrapper">\n            <span class="amst__time amst__seeking">\n              <span>00:00</span>\n            </span>\n          </span>\n        </span>\n      </div>\n      <div class="amst__time amst__time-duration">\n        <span class="amst__duration">00:00</span>\n      </div>`;n+=t,_&&(n+=`        \n      <div class="amst__button amst__fullscreen">\n        <button type="button" title="${e.fullscreen.label}" aria-label="${e.fullscreen.label}" tabindex="0"></button>\n      </div>`);return n+=`\n      <div class="amst__button amst__download">\n        <button type="button" title="${e.download.label}" aria-label="${e.download.label}" tabindex="0"></button>\n      </div>\n    </div>\n  `,n}(this.params),l.parentNode.insertBefore(L,l),l.setAttribute("src",""),l.removeAttribute("src"),l.load(),l.parentNode.removeChild(l);const C=this,M=k(L),B=A(L),$=this.media=M("video"),F=this.container=M(".amst__container"),O=M(".amst__layer-poster"),z=M(".amst__layer-poster canvas"),S=M(".amst__layer-seeking-touch"),N=M(".amst__seeking-touch"),W=M(".amst__layer-play"),H=M(".amst__layer-loading"),X=M(".amst__controls"),D=2*X.css("padding-left"),q=M(".amst__playpause>button"),R=M(".amst__rail"),G=M(".amst__slider"),V=M(".amst__handle"),j=M(".amst__currenttime-bar"),U=M(".amst__seeking"),Y=M(".amst__volumebutton button"),J=M(".amst__volume-slider");let Q,K,Z,ee,te,ae,se,ne,ie,oe,re,le,ue,me,de,ce=0,pe=0,ve=!1,he=!1,_e=!1,fe=0;function be(){let e=$.play();e&&e.catch(()=>{setTimeout(()=>{e=$.play(),e.catch(e=>{ge(),console.log("Error initiating video playback : ",e)})},50)}),y.currentPlayer&&y.currentPlayer!=C&&y.currentPlayer.reset(),y.currentPlayer=C,F.focus(),q.setAttributes({class:"amst__pause",title:C.params.pauseLabel,"aria-label":C.params.pauseLabel}),W.classList.add("amst__hidden"),ve||ye({detail:{delayed:!0}})}function ge(){$.pause(),q.setAttributes({class:"",title:C.params.playLabel,"aria-label":C.params.playLabel}),W.classList.remove("amst__hidden"),Ee(),F.focus()}function ye(e){let t=!!e&&e.detail.delayed,a=!!e&&e.detail.forced;$.paused&&!a||(t||he||ve?(oe&&clearTimeout(oe),oe=setTimeout(()=>ye(),C.params.hideControlsDelay)):(F.focus(),X.style[h]="translateX(-50%) scaleY(0)",_e=!0))}function Ee(){oe&&clearTimeout(oe),X.style[h]="",_e=!1,$.paused||ye({detail:{delayed:!0}})}function we(){window.location=C.src.substring(0,C.src.lastIndexOf("/"))+"/index.php?file="+C.src.substring(C.src.lastIndexOf("/")+1)}function Te(e,t){const a=e.toLowerCase(),s=M(`.amst__${a}`),n=M(`.amst__${a} > button`);!0===C.params[e].disabled?n.setAttribute("disabled",""):n.removeAttribute("disabled"),!0===C.params[e].hidden?s.classList.add("amst__hidden"):s.classList.remove("amst__hidden"),"volumeButton"==e&&J&&(!0===C.params.volumeButton.disabled||!0===C.params.volumeButton.hidden?J.classList.add("amst__hidden"):J.classList.remove("amst__hidden")),n.setAttributes({title:t,"aria-label":t}),Ne()}function Le(){Te("previous",C.params.previous.label)}function xe(){Te("next",C.params.next.label)}function ke(){!1===C.params.download.disabled&&!1===C.params.download.hidden?M(".amst__download>button").on("click",we,!1):M(".amst__download>button").off("click",we),Te("download",C.params.download.label)}function Ae(){me=C.params.fullscreen.label.enter,de=C.params.fullscreen.label.exit,Te("fullscreen",y.currentFullScreenPlayer==C?de:me)}function Ie(){Te("volumeButton",0==C.volume?C.params.volumeButton.label.unmute:C.params.volumeButton.label.mute)}function Pe(e){let t=e.detail;t="object"==typeof t?t:{src:t},isNaN(t.volume)||!0!==t.volumeForced&&m.getItem(`amst_volumegroup${t.volumeGroup}`)?m.getItem(`amst_volumegroup${t.volumeGroup}`)&&(C.params.volume=m.getItem(`amst_volumegroup${t.volumeGroup}`)):(C.params.volume=t.volume,m.setItem(`amst_volumegroup${t.volumeGroup}`,t.volume));const a=["autoplay","crossorigin","download","duration","format","fullscreen","loop","next","playsinline","poster","preload","previous","src","skipTime","thumbnails","volumeButton","volumeGroup"];if(t=a.reduce((e,s)=>(a.includes(s)&&null!=t[s]&&(e[s]=t[s]),e),{}),$.getAttribute("src")){for(F.classList.add("amst_container_transition"),C.media.pause(),pe=0,ce=0,ie=void 0;$.attributes.length>0;)$.removeAttribute($.attributes[0].name);["autoplay","crossorigin","loop","playsinline","thumbnails"].forEach(e=>C.params[e]=y.defaultOptions[e]),F.classList.remove("amst__thumbnails","amst__loadedmetadata"),fe=0,re=void 0,U.removeAttribute("style"),le=void 0,N.removeAttribute("style"),C.params=x(C.params,t)}if(C.params.thumbnails.src&&!g){let e=new Image;const t=function(a){if(e.removeEventListener("load",t),e.removeEventListener("error",t),"load"==a.type){F.classList.add("amst__thumbnails"),fe=e.naturalWidth/C.params.thumbnails.number;let t={width:`${e.naturalWidth/C.params.thumbnails.number}px`,height:`${e.naturalHeight}px`,"background-image":`url("${C.params.thumbnails.src}")`};U.css(t),N.css(t)}else C.params.thumbnails.src=void 0};e.addEventListener("error",t,!1),e.addEventListener("load",t,!1),e.src=C.params.thumbnails.src}let s={src:C.params.src,preload:u?"none":C.params.preload};!0===C.params.playsinline&&(s.playsinline="",s["webkit-playsinline"]=""),!0===C.params.loop&&(s.loop=""),C.params.crossorigin&&(s.crossorigin=C.params.crossorigin),$.setAttributes(s),C.volume=u&&C.params.volume>0?1:C.params.volume,ue||(ue=0==$.volume?.1:$.volume,u&&(ue=1)),$.dispatchEvent(new Event("volumechange")),F.style.paddingBottom=1/C.params.format*100+"%",C.params.poster&&(O.style.backgroundImage=`url("${C.params.poster}")`,O.classList.remove("amst__hidden")),M(".amst__duration").innerHTML=E(C.params.duration),M(".amst__currenttime").innerHTML=E(0,C.params.duration>3600),Le(),xe(),ke(),Ie(),_&&Ae(),1==C.params.autoplay&&($.load(),be())}this.events={next:[],previous:[]},F.on("amstEvent__play",be,!1),F.on("amstEvent__pause",ge,!1),F.on("amstEvent__reset",(function(){z.width=$.videoWidth,z.height=$.videoHeight,z.getContext("2d").drawImage($,0,0,z.width,z.height),O.classList.remove("amst__hidden"),F.classList.remove("amst__loadedmetadata"),$.src="",$.preload="none",$.load(),$.src=C.params.src}),!1),F.on("amstEvent__hideControls",ye,!1),F.on("amstEvent__showControls",Ee,!1),M(".amst__next").on("click",(function(){[...C.events.next].forEach(e=>e.apply(this))})),M(".amst__previous").on("click",(function(){[...C.events.previous].forEach(e=>e.apply(this))})),F.on("amstEvent__previousButton",Le,!1),F.on("amstEvent__nextButton",xe,!1),F.on("amstEvent__fullscreenButton",Ae,!1),F.on("amstEvent__downloadButton",ke,!1),F.on("amstEvent__volumeButton",Ie,!1),F.on("amstEvent__src",Pe,!1),$.on("mousemove",()=>Ee(),!!P&&{passive:!0}).on("loadedmetadata",()=>{let t=this.params.format=$.videoWidth/$.videoHeight;y.currentFullScreenPlayer==C?e.dispatchEvent(new CustomEvent("amst__optimizedResize")):F.style.paddingBottom=1/t*100+"%",F.classList.add("amst__loadedmetadata"),$.currentTime=ce}).on("loadeddata",()=>{$.currentTime=ce}).on("durationchange",()=>{this.params.duration=$.duration,ne="string"==typeof this.params.skipTime&&"%"==this.params.skipTime.slice(-1)?parseFloat(this.params.skipTime)*$.duration/100:parseFloat(this.params.skipTime),$.duration>=3600?F.classList.add("amst__long"):F.classList.remove("amst__long"),G.setAttribute("aria-valuemax",$.duration),M(".amst__duration").innerHTML=E($.duration),M(".amst__currenttime").innerHTML=E(ce,$.duration>3600),Ne()}).on("progress",$e).on("timeupdate",()=>{if(isNaN($.duration))return;$e(),G.setAttribute("aria-valuenow",$.currentTime);let e=Math.floor($.currentTime);if(ce!=e){ce=e;let t=E(ce,$.duration>3600);M(".amst__currenttime").innerHTML=t,G.setAttribute("aria-valuetext",t)}(0==pe||Math.abs($.currentTime-pe)>.5)&&(cancelAnimationFrame(se),Oe()),pe=$.currentTime}).on("ended",()=>{$.currentTime=0,this.pause()}).on("pause",()=>cancelAnimationFrame(se)).on("playing",()=>{pe=0,O.classList.add("amst__hidden")}).on("seeked",()=>{0==ce&&this.paused&&(z.width=0,z.height=0,O.classList.remove("amst__hidden"))}).on("play playing seeked canplay",()=>{he=!1,F.classList.remove("amst__buffering")}).on("seeking waiting loadeddata",()=>{he=!0,F.classList.add("amst__buffering")});const Ce=M(".amst__loaded-bar"),Me=Ce.offsetHeight;let Be=Ce.getContext("2d");function $e(){if(!function(e,t){if(!e||!t||e.length!=t.length)return!1;for(let a=0;a<e.length;a++)if(e.start(a)!=t.start(a)||e.end(a)!=t.end(a))return a=e.length,!1;return!0}($.buffered,ie)){Be.clearRect(0,0,Ce.width,Ce.height);let e=Ce.width/$.duration;for(let t=0;t<$.buffered.length;t++){let a=$.buffered.start(t)*e,s=$.buffered.end(t)*e-a;new w(Be,Me,a,s)}ie=$.buffered}}Ce.height=Me,Be.fillStyle=Ce.css("color");let Fe=.5*V.offsetWidth;function Oe(){let e=$.paused&&!$.seeking?"all .15s ease-in":"none",t=$.currentTime,a=$.duration,s=isNaN(a)?0:(t/a).toFixed(4),n=s*ee-Fe;n=Math.max(n,0),n=Math.min(n,ee-2*Fe)+"px",$.paused?(j.css({[v]:e,[h]:`scaleX(${s})`}),V.css({[v]:e,[h]:`translateX(${n})`})):(j.css({[v]:e,[h]:`scaleX(${s})`}),V.css({[v]:e,[h]:`translateX(${n})`}),se=requestAnimationFrame(Oe))}function ze(e){let t=((e.changedTouches?e.changedTouches[0].clientX:e.clientX)-Z)/ee;$.currentTime=t*$.duration}function Se(e){C.paused||ve||ye({detail:{delayed:!0}}),ze(e),R.off(r,ze),R.off(o+" "+n,Se)}if(B([$,H,S,W]).on("touchstart",(function(e){const t=M(e.target),a=(new Date).getTime(),s=200,n=$.duration?$.currentTime/$.duration:void 0;let i=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY,r=0,l=0,u=0,m=void 0,d=!1;function c(e){if($.duration&&!(C.paused&&u<-5))if(d)e.preventDefault();else{if(u>-5&&e.preventDefault(),r=e.changedTouches[0].pageX-i,l=e.changedTouches[0].pageY-o,Math.abs(r)>Math.abs(l)?u++:u--,u>=5&&!g){m=Math.min(Math.max(n+r/Q,0),.999),le||(le=N.offsetWidth);const e=Math.min(Math.max(m*Q-.5*le,0),Q-le)+"px";let t={[h]:`translateX(${e})`};C.params.thumbnails.src&&(t.backgroundPosition=-Math.floor(100*m)*fe+"px 0"),N.css(t),M(".amst__seeking-touch-cache").style[h]=`scaleX(${m})`,M(".amst__seeking-touch > span").innerHTML=E($.duration*m,$.duration>3600),5==u&&(S.classList.add("amst__show"),ye({detail:{delayed:!1,forced:!0}}))}-5==u&&(l<0?_e&&(Ee(),d=!0):_e||(ye(),d=!0))}}t.on("touchend",(function e(n){n.preventDefault(),null!=m?($.currentTime=$.duration*m,S.classList.remove("amst__show"),Ee()):d||s>(new Date).getTime()-a&&C.togglePlayPause();t.off("touchend",e),t.off("touchmove",c)}),!!P&&{passive:!1}),t.on("touchmove",c,!!P&&{passive:!1})}),!!P&&{passive:!1}),B([$,H]).on("click",()=>this.pause(),!1),F.on("touchstart mousedown",()=>{F.classList.remove("amst__keyboard-active")},!!P&&{passive:!0}),M(".amst__playpause").on("click",()=>this.togglePlayPause()),W.on("click",()=>this.play()),X.on(s,e=>{if("touch"==a||e.pointerType&&"touch"==e.pointerType)return!1;Ee(),ve=!0}).on(n,e=>{if("touch"==a||e.pointerType&&"touch"==e.pointerType)return!1;ve=!1,ye({detail:{delayed:!0}})}),R.on(i,()=>{if(isNaN($.duration))return!1;R.on(r,ze,!!P&&{passive:!0}),R.on(o+" "+n,Se,!1)},!!P&&{passive:!0}),T(r,"optimizedPointerMove",G),G.on("optimizedPointerMove",e=>{if("touch"==a||e.pointerType&&"touch"==e.pointerType||isNaN($.duration))return!1;re||(re=U.offsetWidth);let t=e.detail.clientX-Z;const s=t/ee,n=-Math.floor(100*s)*fe+"px",i=.5*re-6;C.params.thumbnails.src&&(U.style.backgroundPosition=n+" 0"),M(".amst__cursor").style[h]=`translateX(${t}px)`,t=Math.max(t,i),t=Math.min(t,ee-i),M(".amst__seeking-wrapper").style[h]=`translateX(${t}px)`,M(".amst__seeking > span").innerHTML=E(s*$.duration,$.duration>3600)}),$.on("volumechange",()=>{if(!u){const e=parseInt(100*$.volume);J.setAttributes({"aria-valuenow":e,"aria-valuetext":e+"%"}),"horizontal"==I?M(".amst__volume-current").style.width=e+"%":M(".amst__volume-handle").style.bottom=e+"%"}$.muted?Y.setAttributes({title:C.params.volumeButton.label.unmute,"aria-label":C.params.volumeButton.label.unmute,class:"amst__unmute"}):(ue=$.volume,Y.classList.contains("amst__unmute")&&(Y.removeAttribute("class"),Y.setAttributes({title:C.params.volumeButton.label.mute,"aria-label":C.params.volumeButton.label.mute}))),m&&C.params.volumeGroup>-1&&m.setItem(`amst_volumegroup${C.params.volumeGroup}`,C.volume),C.params.volume=C.volume,C.params.volumeGroup>-1&&y.players.length>1&&y.players.forEach(e=>{e!=C&&e.params.volumeGroup==C.params.volumeGroup&&e.volume!=C.volume&&(e.volume=C.volume)})}),Y.on("click",()=>{$.muted?($.volume=ue,$.muted=!1):($.volume=0,$.muted=!0)}),!u){J.on(i,()=>{J.on(r,e).on(n,a).on(o,e).on(o,a)});const e=function(e){let t;"horizontal"==I?(t=Math.max(0,e.clientX-K.left),t/=K.width,t=t>.96?1:t):(J.style.cursor="ns-resize",t=K.height-e.clientY+K.top,t=Math.max(0,Math.min(t,100))/100),C.volume=t},a=function(){J.off(r,e).off(n,a).off(o,e).off(o,a),"vertical"==I&&(J.style.cursor="")};F.on("keydown",(function(e){switch(F.classList.add("amst__keyboard-active"),Ee(),[37,38,39,40,77].includes(e.which)&&e.preventDefault(),e.which>36&&e.which<41&&(38!=e.which&&40!=e.which||t.activeElement==J||("vertical"==I?(J.on("transitionend",(function e(){this.removeEventListener("transitionend",e),this.focus()})),Y.focus()):J.focus()),37!=e.which&&39!=e.which||t.activeElement==G||G.focus()),e.which){case 77:!0!==C.params.volumeButton.disabled&&!0!==C.params.volumeButton.hidden&&(Y.dispatchEvent(new MouseEvent("click")),Y.focus());break;case 40:!0!==C.params.volumeButton.disabled&&!0!==C.params.volumeButton.hidden&&(C.volume=Math.max(0,C.volume-.05));break;case 38:!0!==C.params.volumeButton.disabled&&!0!==C.params.volumeButton.hidden&&(C.volume=Math.min(1,C.volume+.05));break;case 37:C.currentTime=Math.max(0,C.currentTime-ne);break;case 39:C.currentTime=Math.min(C.duration,C.currentTime+ne);break;case 32:if(t.activeElement==q)return;"BUTTON"!=t.activeElement.nodeName&&(e.preventDefault(),C.togglePlayPause())}}),!1)}if(_){let a=0,s=0;const n=M(".amst__fullscreen>button");n.on("click",()=>{null!==t[_.fullscreenElement]?t[_.exitFullscreen]():(a=e.pageXOffset,s=e.pageYOffset,L[_.requestFullscreen](),y.currentFullScreenPlayer=C)}),t.addEventListener(_.fullscreenchange,(function(){t[_.fullscreenElement]==L?(e.addEventListener("amst__optimizedResize",i),L.classList.add("amst__isfullscreen"),F.classList.add("amst__notransition"),n.setAttributes({title:de,"aria-label":de,class:" amst__unfullscreen"}),i()):y.currentFullScreenPlayer==C&&(e.removeEventListener("amst__optimizedResize",i),F.setAttribute("style",`padding-bottom:${1/C.params.format*100}%`),L.classList.remove("amst__isfullscreen"),n.setAttributes({title:me,"aria-label":me,class:""}),setTimeout(()=>{e.scroll(a,s),setTimeout(()=>{F.classList.remove("amst__notransition")},50)},50),y.currentFullScreenPlayer=void 0)}),!1);const i=function(){e.innerWidth/e.innerHeight>C.params.format?F.css({width:e.innerHeight*C.params.format+"px",height:"100%",paddingBottom:0}):F.css({width:"100%",height:"auto",paddingBottom:1/C.params.format*100+"%"}),We()}}function Ne(){ae&&clearTimeout(ae),ae=setTimeout((function(){te=0,B(".amst__controls>div:not(.amst__rail):not(.amst__hidden):not(.amst__time-duration)").forEach(e=>{e.classList.contains("amst__time")?te+=2*e.offsetWidth:te+=e.offsetWidth}),We()}),1)}function We(){Q=F.offsetWidth,Q-D-te<y.defaultOptions.railMinWidthForNormalUI?F.classList.add("amst__compact"):F.classList.remove("amst__compact");let e=G.getBoundingClientRect();if(Z=e.left,ee=e.width,Oe(),!u){const e=function(t){K=M(".amst__volume-total").getBoundingClientRect(),t&&t.target==F&&F.off("transitionend",e)};F.on("transitionend",e,!1),e()}}e.addEventListener("amst__optimizedResize",We),e.addEventListener("amst__optimizedScroll",We),"unknown"==f?F.addEventListener("pointerDetected",(function e(){F.removeEventListener("pointerDetected",e),"touch"!=f&&F.classList.add("amst__no-touch")}),!1):"touch"!=f&&F.classList.add("amst__no-touch"),y.players.push(this),Pe({detail:this.params}),d&&"function"==typeof d.onInit&&setTimeout((function(){d.onInit.call(C)}),0)}set src(e){this.container.dispatchEvent(new CustomEvent("amstEvent__src",{detail:e}))}get src(){return this.media.getAttribute("src")}get paused(){return this.media.paused}get duration(){return this.media.duration}set currentTime(e){this.media.duration&&e>=0&&e<=this.media.duration&&(this.media.currentTime=e)}get currentTime(){return this.media.currentTime}set volume(e){this.media.muted=0==e,this.media.volume=e}get volume(){return this.media.volume}pause(){this.container.dispatchEvent(new CustomEvent("amstEvent__pause"))}play(){this.container.dispatchEvent(new CustomEvent("amstEvent__play"))}reset(){this.pause(),this.container.dispatchEvent(new CustomEvent("amstEvent__reset"))}togglePlayPause(){this.paused?this.play():this.pause()}hideControls(e=!1,t=!1){this.container.dispatchEvent(new CustomEvent("amstEvent__hideControls",{detail:{delayed:e,forced:t}}))}showControls(){this.container.dispatchEvent(new CustomEvent("amstEvent__showControls"))}previous(e){L(e)&&(this.params=x(this.params,{previous:e}),this.container.dispatchEvent(new CustomEvent("amstEvent__previousButton")))}next(e){L(e)&&(this.params=x(this.params.next,{next:e}),this.container.dispatchEvent(new CustomEvent("amstEvent__nextButton")))}fullscreen(e){L(e)&&(this.params=x(this.params,{fullscreen:e}),this.container.dispatchEvent(new CustomEvent("amstEvent__fullscreenButton")))}download(e){L(e)&&(this.params=x(this.params,{download:e}),this.container.dispatchEvent(new CustomEvent("amstEvent__downloadButton")))}volumeButton(e){L(e)&&(this.params=x(this.params,{volumeButton:e}),this.container.dispatchEvent(new CustomEvent("amstEvent__volumeButton")))}on(e,t){this.events.hasOwnProperty(e)&&this.events[e].push(t)}off(e,t){if(this.events.hasOwnProperty(e)){const a=this.events[e].indexOf(t);a>-1&&this.events[e].splice(a,1)}}}function E(e,t){e=Math.round(e);let a=Math.floor(e/3600),s=Math.floor((e-3600*a)/60),n=Math.round(e%60);return a=a>9?a+":":a>0?"0"+a+":":t?"00:":"",s=s>9?s:"0"+s,n=n>9?n:"0"+n,a+s+":"+n}y.currentPlayer=void 0,y.players=[],y.defaultOptions={autoplay:!1,crossorigin:"anonymous",download:{label:"Télécharger",disabled:!1,hidden:!1},duration:120,format:16/9,fullscreen:{label:{enter:"Plein écran",exit:"Quitter le plein écran"},disabled:!1,hidden:!1},loop:!1,next:{label:"Suivant",disabled:!0,hidden:!0},playsinline:!0,poster:void 0,preload:"none",previous:{label:"Précédent",disabled:!0,hidden:!0},skipTime:"1%",thumbnails:{src:void 0,number:100},volume:.8,volumeButton:{label:{mute:"Désactiver le son",unmute:"Activer le son"},disabled:!1,hidden:!1},volumeGroup:0,hideControlsDelay:5e3,videoVolumeOrientation:"vertical",railMinWidthForNormalUI:600,appLabel:"Lecteur Vidéo",pauseLabel:"Pause",playLabel:"Lecture",volumeHelpLabel:"Utilisez les flèches Haut/Bas du clavier pour augmenter ou diminuer le volume.",volumeSliderLabel:"Potentiomètre de volume"};class w{constructor(e,t,a,s){e.beginPath(),e.moveTo(a+2,0),e.lineTo(a+s-2,0),e.quadraticCurveTo(a+s,0,a+s,2),e.lineTo(a+s,0+t-2),e.quadraticCurveTo(a+s,0+t,a+s-2,0+t),e.lineTo(a+2,0+t),e.quadraticCurveTo(a,0+t,a,0+t-2),e.lineTo(a,2),e.quadraticCurveTo(a,0,a+2,0),e.closePath(),e.fill()}}let T=(t,a,s=e)=>{let n=!1;s.addEventListener(t,e=>{n||(n=!0,requestAnimationFrame(()=>{s.dispatchEvent(new CustomEvent(a,{detail:e})),n=!1}))})};function L(e){return e&&"object"==typeof e&&!Array.isArray(e)}function x(e,t){let a=Object.assign({},e);return L(e)&&L(t)&&Object.keys(t).forEach(s=>{L(t[s])&&s in e?a[s]=x(e[s],t[s]):Object.assign(a,{[s]:t[s]})}),a}T("resize","amst__optimizedResize"),T("scroll","amst__optimizedScroll");let k=t=>{return function(a){let s="string"==typeof a?t.querySelector(a):a;return s&&(s.css=t=>{if("string"==typeof t){let a=e.getComputedStyle(s,null).getPropertyValue(t);return isNaN(parseFloat(a))?a:parseFloat(a)}return Object.assign(s.style,t),s},s.setAttributes=e=>{Object.keys(e).forEach(t=>s.setAttribute(t,e[t]))},s.on=function(e,t,a=!1){return e.split(" ").forEach(e=>s.addEventListener(e,t,a)),s},s.off=function(e,t){return e.split(" ").forEach(e=>s.removeEventListener(e,t)),s}),s}},A=e=>{return t=>{let a=Array.isArray(t)?t:Array.from(e.querySelectorAll(t));return a.css=e=>{if("string"==typeof e){let t=window.getComputedStyle(a[0],null).getPropertyValue(e);return isNaN(parseFloat(t))?t:parseFloat(t)}return a.forEach(t=>{Object.assign(t.style,e)}),a},a.on=function(e,t,s=!1){return a.forEach(a=>{e.split(" ").forEach(e=>a.addEventListener(e,t,s))}),a},a.off=function(e,t){return a.forEach(a=>{e.split(" ").forEach(e=>a.removeEventListener(e,t))}),a},a.length?a:null}};return y}();
